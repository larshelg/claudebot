2025-08-11T18:41:27.270Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-11T18:41:27.273Z - INFO - Flink MCP Server running on stdio
2025-08-11T18:44:35.125Z - INFO - POST request to: http://localhost:8083/v3/sessions
2025-08-11T18:44:35.125Z - INFO - POST data: {}
2025-08-11T18:44:35.410Z - INFO - POST response status: 200
2025-08-11T18:44:42.708Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: USE CATALOG fluss_catalog
2025-08-11T18:44:42.708Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:44:42.708Z - INFO - POST data: {"statement":"USE CATALOG fluss_catalog"}
2025-08-11T18:44:42.739Z - INFO - POST response status: 200
2025-08-11T18:44:49.390Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: SELECT COUNT(*) FROM market_data_history
2025-08-11T18:44:49.390Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:44:49.390Z - INFO - POST data: {"statement":"SELECT COUNT(*) FROM market_data_history"}
2025-08-11T18:44:49.402Z - INFO - POST response status: 200
2025-08-11T18:44:54.398Z - INFO - GET request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/operations/0dd3ed6e-8eb3-4279-bc4c-d5703efc6a84/result/0
2025-08-11T18:44:54.448Z - INFO - GET response status: 200
2025-08-11T18:45:01.552Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: SELECT * FROM market_data_history LIMIT 5
2025-08-11T18:45:01.552Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:45:01.552Z - INFO - POST data: {"statement":"SELECT * FROM market_data_history LIMIT 5"}
2025-08-11T18:45:01.560Z - INFO - POST response status: 200
2025-08-11T18:45:07.658Z - INFO - GET request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/operations/ad9479d3-855b-43f6-b269-1ff2fccc40ee/result/0
2025-08-11T18:45:07.671Z - INFO - GET response status: 200
2025-08-11T18:47:09.482Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: SET 'execution.runtime-mode' = 'streaming'
2025-08-11T18:47:09.482Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:47:09.482Z - INFO - POST data: {"statement":"SET 'execution.runtime-mode' = 'streaming'"}
2025-08-11T18:47:09.492Z - INFO - POST response status: 200
2025-08-11T18:47:28.096Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: SET 'table.exec.source.idle-timeout' = '5 s'
2025-08-11T18:47:28.096Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:47:28.096Z - INFO - POST data: {"statement":"SET 'table.exec.source.idle-timeout' = '5 s'"}
2025-08-11T18:47:28.105Z - INFO - POST response status: 200
2025-08-11T18:47:35.451Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: USE CATALOG fluss_catalog
2025-08-11T18:47:35.451Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:47:35.451Z - INFO - POST data: {"statement":"USE CATALOG fluss_catalog"}
2025-08-11T18:47:35.456Z - INFO - POST response status: 200
2025-08-11T18:48:00.939Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE TABLE IF NOT EXISTS fluss.indicators_latest (
  symbol STRING,
  indicator_name STRING,
  indicator_value DECIMAL(18,8),
  `time` TIMESTAMP(3),
  PRIMARY KEY (symbol, indicator_name) NOT ENFORCED
)
2025-08-11T18:48:00.939Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:48:00.939Z - INFO - POST data: {"statement":"CREATE TABLE IF NOT EXISTS fluss.indicators_latest (\n  symbol STRING,\n  indicator_name STRING,\n  indicator_value DECIMAL(18,8),\n  `time` TIMESTAMP(3),\n  PRIMARY KEY (symbol, indicator_name) NOT ENFORCED\n)"}
2025-08-11T18:48:00.946Z - INFO - POST response status: 200
2025-08-11T18:48:18.009Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE TABLE IF NOT EXISTS fluss.indicators_timeseries (
  run_id STRING,
  symbol STRING,
  `time` TIMESTAMP(3),
  indicator_name STRING,
  indicator_value DECIMAL(18,8),
  PRIMARY KEY (run_id, symbol, `time`, indicator_name) NOT ENFORCED,
  WATERMARK FOR `time` AS `time` - INTERVAL '5' SECOND
)
2025-08-11T18:48:18.009Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:48:18.009Z - INFO - POST data: {"statement":"CREATE TABLE IF NOT EXISTS fluss.indicators_timeseries (\n  run_id STRING,\n  symbol STRING,\n  `time` TIMESTAMP(3),\n  indicator_name STRING,\n  indicator_value DECIMAL(18,8),\n  PRIMARY KEY (run_id, symbol, `time`, indicator_name) NOT ENFORCED,\n  WATERMARK FOR `time` AS `time` - INTERVAL '5' SECOND\n)"}
2025-08-11T18:48:18.015Z - INFO - POST response status: 200
2025-08-11T18:48:37.303Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: USE CATALOG default_catalog
2025-08-11T18:48:37.303Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:48:37.303Z - INFO - POST data: {"statement":"USE CATALOG default_catalog"}
2025-08-11T18:48:37.307Z - INFO - POST response status: 200
2025-08-11T18:48:41.121Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS candles_base AS
SELECT 
  `time`,
  symbol,
  `close`
FROM `fluss_catalog`.`fluss`.`market_data_history`
WHERE `close` > 0
2025-08-11T18:48:41.121Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:48:41.121Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS candles_base AS\nSELECT \n  `time`,\n  symbol,\n  `close`\nFROM `fluss_catalog`.`fluss`.`market_data_history`\nWHERE `close` > 0"}
2025-08-11T18:48:41.123Z - INFO - POST response status: 200
2025-08-11T18:49:19.902Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS sma_calculation AS
SELECT
  symbol,
  `time`,
  'SMA_20' AS indicator_name,
  CAST(AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 19 PRECEDING AND CURRENT ROW
  ) AS DECIMAL(18,8)) AS indicator_value
FROM candles_base
2025-08-11T18:49:19.902Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:49:19.902Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_calculation AS\nSELECT\n  symbol,\n  `time`,\n  'SMA_20' AS indicator_name,\n  CAST(AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 19 PRECEDING AND CURRENT ROW\n  ) AS DECIMAL(18,8)) AS indicator_value\nFROM candles_base"}
2025-08-11T18:49:19.913Z - INFO - POST response status: 200
2025-08-11T18:49:46.051Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: INSERT INTO `fluss_catalog`.`fluss`.`indicators_latest`
SELECT
  symbol,
  indicator_name,
  indicator_value,
  `time`
FROM sma_calculation
2025-08-11T18:49:46.051Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:49:46.051Z - INFO - POST data: {"statement":"INSERT INTO `fluss_catalog`.`fluss`.`indicators_latest`\nSELECT\n  symbol,\n  indicator_name,\n  indicator_value,\n  `time`\nFROM sma_calculation"}
2025-08-11T18:49:46.054Z - INFO - POST response status: 200
2025-08-11T18:50:08.710Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: INSERT INTO `fluss_catalog`.`fluss`.`indicators_timeseries`
SELECT
  'live' AS run_id,
  symbol,
  `time`,
  indicator_name,
  indicator_value
FROM sma_calculation
2025-08-11T18:50:08.710Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:50:08.710Z - INFO - POST data: {"statement":"INSERT INTO `fluss_catalog`.`fluss`.`indicators_timeseries`\nSELECT\n  'live' AS run_id,\n  symbol,\n  `time`,\n  indicator_name,\n  indicator_value\nFROM sma_calculation"}
2025-08-11T18:50:08.714Z - INFO - POST response status: 200
2025-08-11T18:50:40.626Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS latest_sma AS
SELECT
  symbol,
  indicator_value AS sma_20,
  `time`
FROM `fluss_catalog`.`fluss`.`indicators_latest`
WHERE indicator_name = 'SMA_20'
2025-08-11T18:50:40.626Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:50:40.626Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS latest_sma AS\nSELECT\n  symbol,\n  indicator_value AS sma_20,\n  `time`\nFROM `fluss_catalog`.`fluss`.`indicators_latest`\nWHERE indicator_name = 'SMA_20'"}
2025-08-11T18:50:40.629Z - INFO - POST response status: 200
2025-08-11T18:50:47.078Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS sma_trends AS
SELECT
  symbol,
  `time`,
  indicator_value AS current_sma,
  LAG(indicator_value) OVER (PARTITION BY symbol ORDER BY `time`) AS previous_sma,
  CASE 
    WHEN indicator_value > LAG(indicator_value) OVER (PARTITION BY symbol ORDER BY `time`) 
    THEN 'RISING'
    WHEN indicator_value < LAG(indicator_value) OVER (PARTITION BY symbol ORDER BY `time`) 
    THEN 'FALLING'
    ELSE 'FLAT'
  END AS trend_direction
FROM `fluss_catalog`.`fluss`.`indicators_timeseries`
WHERE run_id = 'live' 
  AND indicator_name = 'SMA_20'
2025-08-11T18:50:47.078Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:50:47.078Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_trends AS\nSELECT\n  symbol,\n  `time`,\n  indicator_value AS current_sma,\n  LAG(indicator_value) OVER (PARTITION BY symbol ORDER BY `time`) AS previous_sma,\n  CASE \n    WHEN indicator_value > LAG(indicator_value) OVER (PARTITION BY symbol ORDER BY `time`) \n    THEN 'RISING'\n    WHEN indicator_value < LAG(indicator_value) OVER (PARTITION BY symbol ORDER BY `time`) \n    THEN 'FALLING'\n    ELSE 'FLAT'\n  END AS trend_direction\nFROM `fluss_catalog`.`fluss`.`indicators_timeseries`\nWHERE run_id = 'live' \n  AND indicator_name = 'SMA_20'"}
2025-08-11T18:50:47.086Z - INFO - POST response status: 200
2025-08-11T18:50:51.051Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS symbol_latest_indicators AS
SELECT
  symbol,
  indicator_name,
  indicator_value,
  `time`
FROM `fluss_catalog`.`fluss`.`indicators_latest`
ORDER BY symbol, indicator_name
2025-08-11T18:50:51.051Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:50:51.051Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS symbol_latest_indicators AS\nSELECT\n  symbol,\n  indicator_name,\n  indicator_value,\n  `time`\nFROM `fluss_catalog`.`fluss`.`indicators_latest`\nORDER BY symbol, indicator_name"}
2025-08-11T18:50:51.056Z - INFO - POST response status: 200
2025-08-11T18:55:55.116Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS sma_40_calculation AS
SELECT
  symbol,
  `time`,
  'SMA_40' AS indicator_name,
  CAST(AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 39 PRECEDING AND CURRENT ROW
  ) AS DECIMAL(18,8)) AS indicator_value
FROM candles_base
2025-08-11T18:55:55.116Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:55:55.116Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_40_calculation AS\nSELECT\n  symbol,\n  `time`,\n  'SMA_40' AS indicator_name,\n  CAST(AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 39 PRECEDING AND CURRENT ROW\n  ) AS DECIMAL(18,8)) AS indicator_value\nFROM candles_base"}
2025-08-11T18:55:55.124Z - INFO - POST response status: 200
2025-08-11T18:56:27.853Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: INSERT INTO `fluss_catalog`.`fluss`.`indicators_latest`
SELECT
  symbol,
  indicator_name,
  indicator_value,
  `time`
FROM sma_40_calculation
2025-08-11T18:56:27.853Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:56:27.853Z - INFO - POST data: {"statement":"INSERT INTO `fluss_catalog`.`fluss`.`indicators_latest`\nSELECT\n  symbol,\n  indicator_name,\n  indicator_value,\n  `time`\nFROM sma_40_calculation"}
2025-08-11T18:56:27.859Z - INFO - POST response status: 200
2025-08-11T18:56:37.842Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: INSERT INTO `fluss_catalog`.`fluss`.`indicators_timeseries`
SELECT
  'live' AS run_id,
  symbol,
  `time`,
  indicator_name,
  indicator_value
FROM sma_40_calculation
2025-08-11T18:56:37.842Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T18:56:37.842Z - INFO - POST data: {"statement":"INSERT INTO `fluss_catalog`.`fluss`.`indicators_timeseries`\nSELECT\n  'live' AS run_id,\n  symbol,\n  `time`,\n  indicator_name,\n  indicator_value\nFROM sma_40_calculation"}
2025-08-11T18:56:37.852Z - INFO - POST response status: 200
2025-08-11T19:14:20.192Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS sma_crossover_strategy AS
WITH sma_pivot AS (
  SELECT 
    symbol,
    `time`,
    CASE WHEN indicator_name = 'SMA_20' THEN indicator_value END AS sma_20,
    CASE WHEN indicator_name = 'SMA_40' THEN indicator_value END AS sma_40
  FROM `fluss_catalog`.`fluss`.`indicators_timeseries`
  WHERE run_id = 'live' 
    AND indicator_name IN ('SMA_20', 'SMA_40')
),
sma_combined AS (
  SELECT
    symbol,
    `time`,
    MAX(sma_20) AS sma_20,
    MAX(sma_40) AS sma_40
  FROM sma_pivot
  GROUP BY symbol, `time`
  HAVING MAX(sma_20) IS NOT NULL AND MAX(sma_40) IS NOT NULL
)
SELECT
  symbol,
  `time`,
  sma_20,
  sma_40,
  LAG(sma_20) OVER (PARTITION BY symbol ORDER BY `time`) AS prev_sma_20,
  LAG(sma_40) OVER (PARTITION BY symbol ORDER BY `time`) AS prev_sma_40,
  CASE 
    WHEN sma_20 > sma_40 AND LAG(sma_20) OVER (PARTITION BY symbol ORDER BY `time`) <= LAG(sma_40) OVER (PARTITION BY symbol ORDER BY `time`) THEN 'BUY'
    WHEN sma_20 < sma_40 AND LAG(sma_20) OVER (PARTITION BY symbol ORDER BY `time`) >= LAG(sma_40) OVER (PARTITION BY symbol ORDER BY `time`) THEN 'SELL'
    ELSE 'HOLD'
  END AS signal
FROM sma_combined
2025-08-11T19:14:20.192Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T19:14:20.192Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_crossover_strategy AS\nWITH sma_pivot AS (\n  SELECT \n    symbol,\n    `time`,\n    CASE WHEN indicator_name = 'SMA_20' THEN indicator_value END AS sma_20,\n    CASE WHEN indicator_name = 'SMA_40' THEN indicator_value END AS sma_40\n  FROM `fluss_catalog`.`fluss`.`indicators_timeseries`\n  WHERE run_id = 'live' \n    AND indicator_name IN ('SMA_20', 'SMA_40')\n),\nsma_combined AS (\n  SELECT\n    symbol,\n    `time`,\n    MAX(sma_20) AS sma_20,\n    MAX(sma_40) AS sma_40\n  FROM sma_pivot\n  GROUP BY symbol, `time`\n  HAVING MAX(sma_20) IS NOT NULL AND MAX(sma_40) IS NOT NULL\n)\nSELECT\n  symbol,\n  `time`,\n  sma_20,\n  sma_40,\n  LAG(sma_20) OVER (PARTITION BY symbol ORDER BY `time`) AS prev_sma_20,\n  LAG(sma_40) OVER (PARTITION BY symbol ORDER BY `time`) AS prev_sma_40,\n  CASE \n    WHEN sma_20 > sma_40 AND LAG(sma_20) OVER (PARTITION BY symbol ORDER BY `time`) <= LAG(sma_40) OVER (PARTITION BY symbol ORDER BY `time`) THEN 'BUY'\n    WHEN sma_20 < sma_40 AND LAG(sma_20) OVER (PARTITION BY symbol ORDER BY `time`) >= LAG(sma_40) OVER (PARTITION BY symbol ORDER BY `time`) THEN 'SELL'\n    ELSE 'HOLD'\n  END AS signal\nFROM sma_combined"}
2025-08-11T19:14:20.251Z - ERROR - POST request failed: Request failed with status code 500
2025-08-11T19:14:20.252Z - ERROR - Tool execution error: Failed to execute query: Request failed with status code 500
2025-08-11T19:14:20.251Z - ERROR - Response status: 500
2025-08-11T19:14:20.252Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to execute statement.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:217)\n\tat org.apache.flink.table.gateway.rest.handler.statement.ExecuteStatementHandler.handleRequest(ExecuteStatementHandler.java:72)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Session '4d5588f2-87a9-4f5a-a8f9-830a290b41e5' does not exist.\n\tat org.apache.flink.table.gateway.service.session.SessionManagerImpl.getSession(SessionManagerImpl.java:135)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.getSession(SqlGatewayServiceImpl.java:405)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:208)\n\t... 49 more\n\nEnd of exception on server side>"]}
2025-08-11T19:14:36.446Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS sma_crossover_strategy AS
SELECT
  s20.symbol,
  s20.`time`,
  s20.indicator_value AS sma_20,
  s40.indicator_value AS sma_40,
  LAG(s20.indicator_value) OVER (PARTITION BY s20.symbol ORDER BY s20.`time`) AS prev_sma_20,
  LAG(s40.indicator_value) OVER (PARTITION BY s40.symbol ORDER BY s40.`time`) AS prev_sma_40,
  CASE 
    WHEN s20.indicator_value > s40.indicator_value 
         AND LAG(s20.indicator_value) OVER (PARTITION BY s20.symbol ORDER BY s20.`time`) <= LAG(s40.indicator_value) OVER (PARTITION BY s40.symbol ORDER BY s40.`time`) 
    THEN 'BUY'
    WHEN s20.indicator_value < s40.indicator_value 
         AND LAG(s20.indicator_value) OVER (PARTITION BY s20.symbol ORDER BY s20.`time`) >= LAG(s40.indicator_value) OVER (PARTITION BY s40.symbol ORDER BY s40.`time`) 
    THEN 'SELL'
    ELSE 'HOLD'
  END AS signal
FROM `fluss_catalog`.`fluss`.`indicators_timeseries` s20
JOIN `fluss_catalog`.`fluss`.`indicators_timeseries` s40
  ON s20.symbol = s40.symbol 
  AND s20.`time` = s40.`time`
  AND s20.run_id = s40.run_id
WHERE s20.run_id = 'live'
  AND s20.indicator_name = 'SMA_20'
  AND s40.indicator_name = 'SMA_40'
2025-08-11T19:14:36.446Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T19:14:36.446Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_crossover_strategy AS\nSELECT\n  s20.symbol,\n  s20.`time`,\n  s20.indicator_value AS sma_20,\n  s40.indicator_value AS sma_40,\n  LAG(s20.indicator_value) OVER (PARTITION BY s20.symbol ORDER BY s20.`time`) AS prev_sma_20,\n  LAG(s40.indicator_value) OVER (PARTITION BY s40.symbol ORDER BY s40.`time`) AS prev_sma_40,\n  CASE \n    WHEN s20.indicator_value > s40.indicator_value \n         AND LAG(s20.indicator_value) OVER (PARTITION BY s20.symbol ORDER BY s20.`time`) <= LAG(s40.indicator_value) OVER (PARTITION BY s40.symbol ORDER BY s40.`time`) \n    THEN 'BUY'\n    WHEN s20.indicator_value < s40.indicator_value \n         AND LAG(s20.indicator_value) OVER (PARTITION BY s20.symbol ORDER BY s20.`time`) >= LAG(s40.indicator_value) OVER (PARTITION BY s40.symbol ORDER BY s40.`time`) \n    THEN 'SELL'\n    ELSE 'HOLD'\n  END AS signal\nFROM `fluss_catalog`.`fluss`.`indicators_timeseries` s20\nJOIN `fluss_catalog`.`fluss`.`indicators_timeseries` s40\n  ON s20.symbol = s40.symbol \n  AND s20.`time` = s40.`time`\n  AND s20.run_id = s40.run_id\nWHERE s20.run_id = 'live'\n  AND s20.indicator_name = 'SMA_20'\n  AND s40.indicator_name = 'SMA_40'"}
2025-08-11T19:14:36.454Z - ERROR - POST request failed: Request failed with status code 500
2025-08-11T19:14:36.455Z - ERROR - Tool execution error: Failed to execute query: Request failed with status code 500
2025-08-11T19:14:36.454Z - ERROR - Response status: 500
2025-08-11T19:14:36.454Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to execute statement.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:217)\n\tat org.apache.flink.table.gateway.rest.handler.statement.ExecuteStatementHandler.handleRequest(ExecuteStatementHandler.java:72)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Session '4d5588f2-87a9-4f5a-a8f9-830a290b41e5' does not exist.\n\tat org.apache.flink.table.gateway.service.session.SessionManagerImpl.getSession(SessionManagerImpl.java:135)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.getSession(SqlGatewayServiceImpl.java:405)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:208)\n\t... 49 more\n\nEnd of exception on server side>"]}
2025-08-11T19:14:41.553Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS sma_values AS
SELECT
  symbol,
  MAX(CASE WHEN indicator_name = 'SMA_20' THEN indicator_value END) AS sma_20,
  MAX(CASE WHEN indicator_name = 'SMA_40' THEN indicator_value END) AS sma_40,
  MAX(`time`) AS latest_time
FROM `fluss_catalog`.`fluss`.`indicators_latest`
WHERE indicator_name IN ('SMA_20', 'SMA_40')
GROUP BY symbol
2025-08-11T19:14:41.553Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T19:14:41.553Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_values AS\nSELECT\n  symbol,\n  MAX(CASE WHEN indicator_name = 'SMA_20' THEN indicator_value END) AS sma_20,\n  MAX(CASE WHEN indicator_name = 'SMA_40' THEN indicator_value END) AS sma_40,\n  MAX(`time`) AS latest_time\nFROM `fluss_catalog`.`fluss`.`indicators_latest`\nWHERE indicator_name IN ('SMA_20', 'SMA_40')\nGROUP BY symbol"}
2025-08-11T19:14:41.561Z - ERROR - POST request failed: Request failed with status code 500
2025-08-11T19:14:41.561Z - ERROR - Tool execution error: Failed to execute query: Request failed with status code 500
2025-08-11T19:14:41.561Z - ERROR - Response status: 500
2025-08-11T19:14:41.561Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to execute statement.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:217)\n\tat org.apache.flink.table.gateway.rest.handler.statement.ExecuteStatementHandler.handleRequest(ExecuteStatementHandler.java:72)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Session '4d5588f2-87a9-4f5a-a8f9-830a290b41e5' does not exist.\n\tat org.apache.flink.table.gateway.service.session.SessionManagerImpl.getSession(SessionManagerImpl.java:135)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.getSession(SqlGatewayServiceImpl.java:405)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:208)\n\t... 49 more\n\nEnd of exception on server side>"]}
2025-08-11T19:14:45.423Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: SELECT * FROM `fluss_catalog`.`fluss`.`indicators_latest` LIMIT 3
2025-08-11T19:14:45.423Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T19:14:45.424Z - INFO - POST data: {"statement":"SELECT * FROM `fluss_catalog`.`fluss`.`indicators_latest` LIMIT 3"}
2025-08-11T19:14:45.430Z - ERROR - POST request failed: Request failed with status code 500
2025-08-11T19:14:45.431Z - ERROR - Tool execution error: Failed to execute query: Request failed with status code 500
2025-08-11T19:14:45.431Z - ERROR - Response status: 500
2025-08-11T19:14:45.431Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to execute statement.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:217)\n\tat org.apache.flink.table.gateway.rest.handler.statement.ExecuteStatementHandler.handleRequest(ExecuteStatementHandler.java:72)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Session '4d5588f2-87a9-4f5a-a8f9-830a290b41e5' does not exist.\n\tat org.apache.flink.table.gateway.service.session.SessionManagerImpl.getSession(SessionManagerImpl.java:135)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.getSession(SqlGatewayServiceImpl.java:405)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:208)\n\t... 49 more\n\nEnd of exception on server side>"]}
2025-08-11T20:28:24.082Z - INFO - Executing query: /v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements with statement: CREATE VIEW IF NOT EXISTS sma_5_calculation AS
SELECT
  symbol,
  `time`,
  'SMA_5' AS indicator_name,
  CAST(AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
  ) AS DECIMAL(18,8)) AS indicator_value
FROM candles_base
2025-08-11T20:28:24.082Z - INFO - POST request to: http://localhost:8083/v3/sessions/4d5588f2-87a9-4f5a-a8f9-830a290b41e5/statements
2025-08-11T20:28:24.082Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_5_calculation AS\nSELECT\n  symbol,\n  `time`,\n  'SMA_5' AS indicator_name,\n  CAST(AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n  ) AS DECIMAL(18,8)) AS indicator_value\nFROM candles_base"}
2025-08-11T20:28:24.100Z - ERROR - POST request failed: Request failed with status code 500
2025-08-11T20:28:24.100Z - ERROR - Tool execution error: Failed to execute query: Request failed with status code 500
2025-08-11T20:28:24.100Z - ERROR - Response status: 500
2025-08-11T20:28:24.100Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to execute statement.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:217)\n\tat org.apache.flink.table.gateway.rest.handler.statement.ExecuteStatementHandler.handleRequest(ExecuteStatementHandler.java:72)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Session '4d5588f2-87a9-4f5a-a8f9-830a290b41e5' does not exist.\n\tat org.apache.flink.table.gateway.service.session.SessionManagerImpl.getSession(SessionManagerImpl.java:135)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.getSession(SqlGatewayServiceImpl.java:405)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:208)\n\t... 49 more\n\nEnd of exception on server side>"]}
2025-08-11T20:28:31.166Z - INFO - POST request to: http://localhost:8083/v3/sessions
2025-08-11T20:28:31.166Z - INFO - POST data: {}
2025-08-11T20:28:31.182Z - INFO - POST response status: 200
2025-08-11T20:28:35.151Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: USE CATALOG default_catalog
2025-08-11T20:28:35.151Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:28:35.151Z - INFO - POST data: {"statement":"USE CATALOG default_catalog"}
2025-08-11T20:28:35.153Z - INFO - POST response status: 200
2025-08-11T20:28:39.471Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: CREATE VIEW IF NOT EXISTS sma_5_calculation AS
SELECT
  symbol,
  `time`,
  'SMA_5' AS indicator_name,
  CAST(AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
  ) AS DECIMAL(18,8)) AS indicator_value
FROM candles_base
2025-08-11T20:28:39.471Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:28:39.471Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS sma_5_calculation AS\nSELECT\n  symbol,\n  `time`,\n  'SMA_5' AS indicator_name,\n  CAST(AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n  ) AS DECIMAL(18,8)) AS indicator_value\nFROM candles_base"}
2025-08-11T20:28:39.473Z - INFO - POST response status: 200
2025-08-11T20:29:00.232Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: SELECT * FROM sma_5_calculation LIMIT 10
2025-08-11T20:29:00.233Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:29:00.233Z - INFO - POST data: {"statement":"SELECT * FROM sma_5_calculation LIMIT 10"}
2025-08-11T20:29:00.237Z - INFO - POST response status: 200
2025-08-11T20:29:07.279Z - INFO - GET request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/operations/edb000a6-91ec-4d69-bdd5-4c6652986194/result/0
2025-08-11T20:29:07.287Z - ERROR - GET request failed: Request failed with status code 500
2025-08-11T20:29:07.287Z - ERROR - Tool execution error: Failed to fetch results: Request failed with status code 500
2025-08-11T20:29:07.287Z - ERROR - Response status: 500
2025-08-11T20:29:07.287Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:91)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.fetchResults(SqlGatewayServiceImpl.java:231)\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:89)\n\t... 48 more\nCaused by: org.apache.flink.table.gateway.service.utils.SqlExecutionException: Failed to execute the operation edb000a6-91ec-4d69-bdd5-4c6652986194.\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.processThrowable(OperationManager.java:414)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:267)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\t... 1 more\nCaused by: org.apache.flink.table.api.ValidationException: SQL validation failed. From line 1, column 15 to line 1, column 31: Object 'sma_5_calculation' not found\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.org$apache$flink$table$planner$calcite$FlinkPlannerImpl$$validate(FlinkPlannerImpl.scala:203)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.validate(FlinkPlannerImpl.scala:117)\n\tat org.apache.flink.table.planner.operations.SqlNodeToOperationConversion.convert(SqlNodeToOperationConversion.java:260)\n\tat org.apache.flink.table.planner.delegation.ParserImpl.parse(ParserImpl.java:106)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:219)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:199)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.lambda$executeStatement$1(SqlGatewayServiceImpl.java:214)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager.lambda$submitOperation$1(OperationManager.java:119)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:258)\n\t... 7 more\nCaused by: org.apache.calcite.runtime.CalciteContextException: From line 1, column 15 to line 1, column 31: Object 'sma_5_calculation' not found\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.calcite.runtime.Resources$ExInstWithCause.ex(Resources.java:505)\n\tat org.apache.calcite.sql.SqlUtil.newContextException(SqlUtil.java:932)\n\tat org.apache.calcite.sql.SqlUtil.newContextException(SqlUtil.java:917)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.newValidationError(SqlValidatorImpl.java:5279)\n\tat org.apache.calcite.sql.validate.IdentifierNamespace.resolveImpl(IdentifierNamespace.java:183)\n\tat org.apache.calcite.sql.validate.IdentifierNamespace.validateImpl(IdentifierNamespace.java:188)\n\tat org.apache.calcite.sql.validate.AbstractNamespace.validate(AbstractNamespace.java:89)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateNamespace(SqlValidatorImpl.java:1062)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateQuery(SqlValidatorImpl.java:1037)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateFrom(SqlValidatorImpl.java:3322)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateFrom(SqlValidatorImpl.java:3304)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateSelect(SqlValidatorImpl.java:3631)\n\tat org.apache.calcite.sql.validate.SelectNamespace.validateImpl(SelectNamespace.java:64)\n\tat org.apache.calcite.sql.validate.AbstractNamespace.validate(AbstractNamespace.java:89)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateNamespace(SqlValidatorImpl.java:1062)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateQuery(SqlValidatorImpl.java:1037)\n\tat org.apache.calcite.sql.SqlSelect.validate(SqlSelect.java:248)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateScopedExpression(SqlValidatorImpl.java:1012)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validate(SqlValidatorImpl.java:761)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.org$apache$flink$table$planner$calcite$FlinkPlannerImpl$$validate(FlinkPlannerImpl.scala:199)\n\t... 15 more\nCaused by: org.apache.calcite.sql.validate.SqlValidatorException: Object 'sma_5_calculation' not found\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.calcite.runtime.Resources$ExInstWithCause.ex(Resources.java:505)\n\tat org.apache.calcite.runtime.Resources$ExInst.ex(Resources.java:599)\n\t... 34 more\n\nEnd of exception on server side>"]}
2025-08-11T20:29:11.580Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: SHOW VIEWS
2025-08-11T20:29:11.580Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:29:11.580Z - INFO - POST data: {"statement":"SHOW VIEWS"}
2025-08-11T20:29:11.582Z - INFO - POST response status: 200
2025-08-11T20:29:21.752Z - INFO - GET request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/operations/8d5bdc18-c2f6-4fd4-bd10-e3169322103a/result/0
2025-08-11T20:29:21.756Z - INFO - GET response status: 200
2025-08-11T20:29:27.974Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: CREATE VIEW IF NOT EXISTS candles_base AS
SELECT 
  `time`,
  symbol,
  `close`
FROM `fluss_catalog`.`fluss`.`market_data_history`
WHERE `close` > 0
2025-08-11T20:29:27.974Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:29:27.974Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS candles_base AS\nSELECT \n  `time`,\n  symbol,\n  `close`\nFROM `fluss_catalog`.`fluss`.`market_data_history`\nWHERE `close` > 0"}
2025-08-11T20:29:27.978Z - INFO - POST response status: 200
2025-08-11T20:29:32.795Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: SELECT
  symbol,
  `time`,
  'SMA_5' AS indicator_name,
  CAST(AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
  ) AS DECIMAL(18,8)) AS indicator_value
FROM candles_base
LIMIT 10
2025-08-11T20:29:32.795Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:29:32.795Z - INFO - POST data: {"statement":"SELECT\n  symbol,\n  `time`,\n  'SMA_5' AS indicator_name,\n  CAST(AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n  ) AS DECIMAL(18,8)) AS indicator_value\nFROM candles_base\nLIMIT 10"}
2025-08-11T20:29:32.799Z - INFO - POST response status: 200
2025-08-11T20:29:38.378Z - INFO - GET request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/operations/c4a21cfd-962e-405a-b593-841f5b872a14/result/0
2025-08-11T20:29:38.383Z - INFO - GET response status: 200
2025-08-11T20:30:18.930Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: INSERT INTO `fluss_catalog`.`fluss`.`indicators_latest`
SELECT
  symbol,
  'SMA_5' AS indicator_name,
  CAST(AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
  ) AS DECIMAL(18,8)) AS indicator_value,
  `time`
FROM candles_base
2025-08-11T20:30:18.930Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:30:18.930Z - INFO - POST data: {"statement":"INSERT INTO `fluss_catalog`.`fluss`.`indicators_latest`\nSELECT\n  symbol,\n  'SMA_5' AS indicator_name,\n  CAST(AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n  ) AS DECIMAL(18,8)) AS indicator_value,\n  `time`\nFROM candles_base"}
2025-08-11T20:30:18.933Z - INFO - POST response status: 200
2025-08-11T20:30:26.597Z - INFO - Executing query: /v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements with statement: INSERT INTO `fluss_catalog`.`fluss`.`indicators_timeseries`
SELECT
  'live' AS run_id,
  symbol,
  `time`,
  'SMA_5' AS indicator_name,
  CAST(AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
  ) AS DECIMAL(18,8)) AS indicator_value
FROM candles_base
2025-08-11T20:30:26.597Z - INFO - POST request to: http://localhost:8083/v3/sessions/3603f18c-2de3-41d5-9ee3-0cbd7f0544bc/statements
2025-08-11T20:30:26.597Z - INFO - POST data: {"statement":"INSERT INTO `fluss_catalog`.`fluss`.`indicators_timeseries`\nSELECT\n  'live' AS run_id,\n  symbol,\n  `time`,\n  'SMA_5' AS indicator_name,\n  CAST(AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n  ) AS DECIMAL(18,8)) AS indicator_value\nFROM candles_base"}
2025-08-11T20:30:26.602Z - INFO - POST response status: 200
2025-08-12T22:23:13.225Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-12T22:23:13.229Z - INFO - Flink MCP Server running on stdio
2025-08-12T22:24:16.483Z - INFO - POST request to: http://localhost:8083/v3/sessions
2025-08-12T22:24:16.484Z - INFO - POST data: {}
2025-08-12T22:24:16.553Z - INFO - POST response status: 200
2025-08-12T22:24:26.981Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: SET 'execution.runtime-mode' = 'streaming';
2025-08-12T22:24:26.981Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:24:26.981Z - INFO - POST data: {"statement":"SET 'execution.runtime-mode' = 'streaming';"}
2025-08-12T22:24:26.990Z - INFO - POST response status: 200
2025-08-12T22:24:32.594Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/58d4cd6e-003f-425a-bd8a-809d1cc7daae/result/0
2025-08-12T22:24:32.604Z - INFO - GET response status: 200
2025-08-12T22:24:36.528Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: SET 'table.exec.source.idle-timeout' = '5 s';
2025-08-12T22:24:36.528Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:24:36.528Z - INFO - POST data: {"statement":"SET 'table.exec.source.idle-timeout' = '5 s';"}
2025-08-12T22:24:36.534Z - INFO - POST response status: 200
2025-08-12T22:24:42.284Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/a96b97c0-ea53-491e-8c67-f585211e8b82/result/0
2025-08-12T22:24:42.293Z - INFO - GET response status: 200
2025-08-12T22:25:16.048Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: CREATE TABLE IF NOT EXISTS fluss.sma_timeseries (
  run_id STRING,
  symbol STRING,
  `time` TIMESTAMP(3),
  sma_5 DECIMAL(18,8),
  sma_14 DECIMAL(18,8),
  sma_21 DECIMAL(18,8),
  PRIMARY KEY (run_id, symbol, `time`) NOT ENFORCED,
  WATERMARK FOR `time` AS `time` - INTERVAL '5' SECOND
);
2025-08-12T22:25:16.049Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:25:16.049Z - INFO - POST data: {"statement":"CREATE TABLE IF NOT EXISTS fluss.sma_timeseries (\n  run_id STRING,\n  symbol STRING,\n  `time` TIMESTAMP(3),\n  sma_5 DECIMAL(18,8),\n  sma_14 DECIMAL(18,8),\n  sma_21 DECIMAL(18,8),\n  PRIMARY KEY (run_id, symbol, `time`) NOT ENFORCED,\n  WATERMARK FOR `time` AS `time` - INTERVAL '5' SECOND\n);"}
2025-08-12T22:25:16.052Z - INFO - POST response status: 200
2025-08-12T22:25:25.221Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/9163c8d9-4b70-42ac-b16b-3abfa0fcbfe0/result/0
2025-08-12T22:25:25.229Z - ERROR - GET request failed: Request failed with status code 500
2025-08-12T22:25:25.229Z - ERROR - Tool execution error: Failed to fetch results: Request failed with status code 500
2025-08-12T22:25:25.229Z - ERROR - Response status: 500
2025-08-12T22:25:25.229Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:91)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.fetchResults(SqlGatewayServiceImpl.java:231)\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:89)\n\t... 48 more\nCaused by: org.apache.flink.table.gateway.service.utils.SqlExecutionException: Failed to execute the operation 9163c8d9-4b70-42ac-b16b-3abfa0fcbfe0.\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.processThrowable(OperationManager.java:414)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:267)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\t... 1 more\nCaused by: org.apache.flink.table.api.TableException: Could not execute CreateTable in path `default_catalog`.`fluss`.`sma_timeseries`\n\tat org.apache.flink.table.catalog.CatalogManager.execute(CatalogManager.java:1367)\n\tat org.apache.flink.table.catalog.CatalogManager.createTable(CatalogManager.java:997)\n\tat org.apache.flink.table.operations.ddl.CreateTableOperation.execute(CreateTableOperation.java:86)\n\tat org.apache.flink.table.api.internal.TableEnvironmentImpl.executeInternal(TableEnvironmentImpl.java:1102)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.callOperation(OperationExecutor.java:687)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeOperation(OperationExecutor.java:522)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:243)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:199)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.lambda$executeStatement$1(SqlGatewayServiceImpl.java:214)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager.lambda$submitOperation$1(OperationManager.java:119)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:258)\n\t... 7 more\nCaused by: org.apache.flink.table.api.ValidationException: Table options do not contain an option key 'connector' for discovering a connector. Therefore, Flink assumes a managed table. However, a managed table factory that implements org.apache.flink.table.factories.ManagedTableFactory is not in the classpath.\n\tat org.apache.flink.table.factories.FactoryUtil.discoverManagedTableFactory(FactoryUtil.java:860)\n\tat org.apache.flink.table.factories.ManagedTableFactory.discoverManagedTableFactory(ManagedTableFactory.java:66)\n\tat org.apache.flink.table.catalog.ManagedTableListener.enrichOptions(ManagedTableListener.java:167)\n\tat org.apache.flink.table.catalog.ManagedTableListener.notifyTableCreation(ManagedTableListener.java:66)\n\tat org.apache.flink.table.catalog.CatalogManager.lambda$createTable$18(CatalogManager.java:1001)\n\tat org.apache.flink.table.catalog.CatalogManager.execute(CatalogManager.java:1361)\n\t... 17 more\n\nEnd of exception on server side>"]}
2025-08-12T22:25:30.316Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: USE CATALOG default_catalog;
2025-08-12T22:25:30.316Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:25:30.316Z - INFO - POST data: {"statement":"USE CATALOG default_catalog;"}
2025-08-12T22:25:30.321Z - INFO - POST response status: 200
2025-08-12T22:25:41.127Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/0365e678-76d8-4bbe-b196-6895f8bf232b/result/0
2025-08-12T22:25:41.142Z - INFO - GET response status: 200
2025-08-12T22:26:21.766Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: CREATE VIEW IF NOT EXISTS candles_base AS
SELECT 
  `time`,
  symbol,
  `close`
FROM `fluss_catalog`.`fluss`.`market_data_history`
WHERE `close` > 0;
2025-08-12T22:26:21.766Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:26:21.766Z - INFO - POST data: {"statement":"CREATE VIEW IF NOT EXISTS candles_base AS\nSELECT \n  `time`,\n  symbol,\n  `close`\nFROM `fluss_catalog`.`fluss`.`market_data_history`\nWHERE `close` > 0;"}
2025-08-12T22:26:21.771Z - INFO - POST response status: 200
2025-08-12T22:26:38.294Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/3287d3af-57b4-4780-bcc3-753dc77c0a84/result/0
2025-08-12T22:26:38.299Z - INFO - GET response status: 200
2025-08-12T22:27:07.039Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: CREATE VIEW sma_5 AS
SELECT
  symbol,
  `time`,
  AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW
  ) AS sma_5
FROM candles_base;
2025-08-12T22:27:07.040Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:27:07.040Z - INFO - POST data: {"statement":"CREATE VIEW sma_5 AS\nSELECT\n  symbol,\n  `time`,\n  AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 4 PRECEDING AND CURRENT ROW\n  ) AS sma_5\nFROM candles_base;"}
2025-08-12T22:27:07.043Z - INFO - POST response status: 200
2025-08-12T22:27:10.643Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/79a0da0d-fb97-4220-92b2-ed64889b7848/result/0
2025-08-12T22:27:10.646Z - INFO - GET response status: 200
2025-08-12T22:27:15.771Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: CREATE VIEW sma_14 AS
SELECT
  symbol,
 `time`,
  AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 13 PRECEDING AND CURRENT ROW
  ) AS sma_14
FROM candles_base;
2025-08-12T22:27:15.771Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:27:15.771Z - INFO - POST data: {"statement":"CREATE VIEW sma_14 AS\nSELECT\n  symbol,\n `time`,\n  AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 13 PRECEDING AND CURRENT ROW\n  ) AS sma_14\nFROM candles_base;"}
2025-08-12T22:27:15.774Z - INFO - POST response status: 200
2025-08-12T22:27:19.808Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/a813f407-8cad-4a14-acca-218f3f57a59e/result/0
2025-08-12T22:27:19.811Z - INFO - GET response status: 200
2025-08-12T22:27:24.595Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: CREATE VIEW sma_21 AS
SELECT
  symbol,
  `time`,
  AVG(`close`) OVER (
    PARTITION BY symbol
    ORDER BY `time`
    ROWS BETWEEN 20 PRECEDING AND CURRENT ROW
  ) AS sma_21
FROM candles_base;
2025-08-12T22:27:24.595Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:27:24.595Z - INFO - POST data: {"statement":"CREATE VIEW sma_21 AS\nSELECT\n  symbol,\n  `time`,\n  AVG(`close`) OVER (\n    PARTITION BY symbol\n    ORDER BY `time`\n    ROWS BETWEEN 20 PRECEDING AND CURRENT ROW\n  ) AS sma_21\nFROM candles_base;"}
2025-08-12T22:27:24.597Z - INFO - POST response status: 200
2025-08-12T22:27:28.948Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/bb378c02-5f79-4221-8ede-92e6656dbc19/result/0
2025-08-12T22:27:28.951Z - INFO - GET response status: 200
2025-08-12T22:28:12.990Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: SELECT symbol, `time`, sma_5 FROM sma_5 ORDER BY `time` DESC LIMIT 10;
2025-08-12T22:28:12.990Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:28:12.990Z - INFO - POST data: {"statement":"SELECT symbol, `time`, sma_5 FROM sma_5 ORDER BY `time` DESC LIMIT 10;"}
2025-08-12T22:28:12.996Z - INFO - POST response status: 200
2025-08-12T22:28:17.330Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/41299f04-e9b5-438b-83c1-0154d46a4514/result/0
2025-08-12T22:28:17.335Z - INFO - GET response status: 200
2025-08-12T22:28:21.996Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: SELECT symbol, `time`, `close` FROM candles_base ORDER BY `time` DESC LIMIT 5;
2025-08-12T22:28:21.996Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:28:21.996Z - INFO - POST data: {"statement":"SELECT symbol, `time`, `close` FROM candles_base ORDER BY `time` DESC LIMIT 5;"}
2025-08-12T22:28:21.999Z - INFO - POST response status: 200
2025-08-12T22:28:26.430Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/b4a428af-4909-4713-a98b-2fcf1ac4496c/result/0
2025-08-12T22:28:26.431Z - INFO - GET response status: 200
2025-08-12T22:28:31.501Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: SELECT COUNT(*) as row_count FROM `fluss_catalog`.`fluss`.`market_data_history`;
2025-08-12T22:28:31.501Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:28:31.501Z - INFO - POST data: {"statement":"SELECT COUNT(*) as row_count FROM `fluss_catalog`.`fluss`.`market_data_history`;"}
2025-08-12T22:28:31.506Z - INFO - POST response status: 200
2025-08-12T22:28:36.304Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/34e65831-3506-44bb-b48b-4ca837ed574d/result/0
2025-08-12T22:28:36.307Z - INFO - GET response status: 200
2025-08-12T22:31:43.843Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: USE CATALOG fluss_catalog;
2025-08-12T22:31:43.843Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:31:43.843Z - INFO - POST data: {"statement":"USE CATALOG fluss_catalog;"}
2025-08-12T22:31:43.851Z - INFO - POST response status: 200
2025-08-12T22:31:48.225Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/b5bee5e3-f2a0-4985-a029-5dbd94e1e701/result/0
2025-08-12T22:31:48.230Z - INFO - GET response status: 200
2025-08-12T22:31:53.357Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: SELECT symbol, `time`, `close` FROM fluss.market_data_history ORDER BY `time` DESC LIMIT 5;
2025-08-12T22:31:53.358Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:31:53.358Z - INFO - POST data: {"statement":"SELECT symbol, `time`, `close` FROM fluss.market_data_history ORDER BY `time` DESC LIMIT 5;"}
2025-08-12T22:31:53.360Z - INFO - POST response status: 200
2025-08-12T22:31:57.476Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/f2d2d989-7333-49e5-b519-ce73992570da/result/0
2025-08-12T22:31:57.480Z - INFO - GET response status: 200
2025-08-12T22:33:13.839Z - INFO - Executing query: /v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements with statement: SELECT * FROM market_data_history LIMIT 5;
2025-08-12T22:33:13.839Z - INFO - POST request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/statements
2025-08-12T22:33:13.839Z - INFO - POST data: {"statement":"SELECT * FROM market_data_history LIMIT 5;"}
2025-08-12T22:33:13.842Z - INFO - POST response status: 200
2025-08-12T22:33:18.103Z - INFO - GET request to: http://localhost:8083/v3/sessions/f3e3edff-e0fe-4827-bb3a-0909ab76285a/operations/29c248d6-dc81-4b6b-a0b1-ca95300cfaa3/result/0
2025-08-12T22:33:18.107Z - INFO - GET response status: 200
2025-08-15T14:48:20.340Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-15T14:48:20.344Z - INFO - Flink MCP Server running on stdio
2025-08-15T16:16:30.078Z - INFO - POST request to: http://localhost:8083/v3/sessions
2025-08-15T16:16:30.079Z - INFO - POST data: {}
2025-08-15T16:16:30.271Z - INFO - POST response status: 200
2025-08-15T16:16:37.913Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: USE CATALOG fluss_catalog
2025-08-15T16:16:37.913Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:16:37.913Z - INFO - POST data: {"statement":"USE CATALOG fluss_catalog"}
2025-08-15T16:16:37.930Z - INFO - POST response status: 200
2025-08-15T16:16:45.848Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: USE fluss
2025-08-15T16:16:45.848Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:16:45.848Z - INFO - POST data: {"statement":"USE fluss"}
2025-08-15T16:16:45.857Z - INFO - POST response status: 200
2025-08-15T16:16:53.390Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SHOW TABLES
2025-08-15T16:16:53.390Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:16:53.390Z - INFO - POST data: {"statement":"SHOW TABLES"}
2025-08-15T16:16:53.399Z - INFO - POST response status: 200
2025-08-15T16:17:02.035Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/bb4983b0-f393-4ac5-893a-4823a36b7674/result/0
2025-08-15T16:17:02.064Z - INFO - GET response status: 200
2025-08-15T16:17:10.502Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SHOW DATABASES
2025-08-15T16:17:10.502Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:17:10.502Z - INFO - POST data: {"statement":"SHOW DATABASES"}
2025-08-15T16:17:10.512Z - INFO - POST response status: 200
2025-08-15T16:17:18.350Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/bce8d131-3df9-4b47-9c05-ae204d1d1f06/result/0
2025-08-15T16:17:18.361Z - INFO - GET response status: 200
2025-08-15T16:17:29.849Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: CREATE TABLE IF NOT EXISTS indicators (
    symbol STRING NOT NULL,
    `time` TIMESTAMP(3),
    sma5 DOUBLE,
    sma14 DOUBLE,
    sma21 DOUBLE,
    ema5 DOUBLE,
    ema14 DOUBLE,
    ema21 DOUBLE,
    rsi14 DOUBLE,
    PRIMARY KEY (symbol) NOT ENFORCED
) WITH (
    'bucket' = '4'
)
2025-08-15T16:17:29.849Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:17:29.849Z - INFO - POST data: {"statement":"CREATE TABLE IF NOT EXISTS indicators (\n    symbol STRING NOT NULL,\n    `time` TIMESTAMP(3),\n    sma5 DOUBLE,\n    sma14 DOUBLE,\n    sma21 DOUBLE,\n    ema5 DOUBLE,\n    ema14 DOUBLE,\n    ema21 DOUBLE,\n    rsi14 DOUBLE,\n    PRIMARY KEY (symbol) NOT ENFORCED\n) WITH (\n    'bucket' = '4'\n)"}
2025-08-15T16:17:29.859Z - INFO - POST response status: 200
2025-08-15T16:17:38.564Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SHOW TABLES
2025-08-15T16:17:38.564Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:17:38.564Z - INFO - POST data: {"statement":"SHOW TABLES"}
2025-08-15T16:17:38.574Z - INFO - POST response status: 200
2025-08-15T16:17:46.834Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/5f0e489d-7357-4c51-a97c-642cc0503a20/result/0
2025-08-15T16:17:46.841Z - INFO - GET response status: 200
2025-08-15T16:19:46.256Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT * FROM indicators LIMIT 10
2025-08-15T16:19:46.256Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:19:46.256Z - INFO - POST data: {"statement":"SELECT * FROM indicators LIMIT 10"}
2025-08-15T16:19:46.272Z - INFO - POST response status: 200
2025-08-15T16:19:55.242Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/5890a6b3-5910-4801-a04a-5896b9d0002c/result/0
2025-08-15T16:19:55.259Z - ERROR - GET request failed: Request failed with status code 500
2025-08-15T16:19:55.259Z - ERROR - Tool execution error: Failed to fetch results: Request failed with status code 500
2025-08-15T16:19:55.259Z - ERROR - Response status: 500
2025-08-15T16:19:55.259Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:91)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.fetchResults(SqlGatewayServiceImpl.java:231)\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:89)\n\t... 48 more\nCaused by: org.apache.flink.table.gateway.service.utils.SqlExecutionException: Failed to execute the operation 5890a6b3-5910-4801-a04a-5896b9d0002c.\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.processThrowable(OperationManager.java:414)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:267)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\t... 1 more\nCaused by: org.apache.flink.table.api.ValidationException: Unable to create a source for reading table 'fluss_catalog.fluss.indicators'.\n\nTable options are:\n\n'bootstrap.servers'='coordinator-server:9123'\n'bucket'='4'\n'bucket.key'='symbol'\n'bucket.num'='1'\n'table.datalake.format'='paimon'\n'table.replication.factor'='1'\n\tat org.apache.flink.table.factories.FactoryUtil.createDynamicTableSource(FactoryUtil.java:235)\n\tat org.apache.flink.table.factories.FactoryUtil.createDynamicTableSource(FactoryUtil.java:260)\n\tat org.apache.flink.table.planner.plan.schema.CatalogSourceTable.createDynamicTableSource(CatalogSourceTable.java:175)\n\tat org.apache.flink.table.planner.plan.schema.CatalogSourceTable.toRel(CatalogSourceTable.java:115)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.toRel(SqlToRelConverter.java:4034)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertIdentifier(SqlToRelConverter.java:2904)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2464)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2378)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2323)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertSelectImpl(SqlToRelConverter.java:730)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertSelect(SqlToRelConverter.java:716)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertQueryRecursive(SqlToRelConverter.java:3880)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertQuery(SqlToRelConverter.java:620)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.org$apache$flink$table$planner$calcite$FlinkPlannerImpl$$rel(FlinkPlannerImpl.scala:233)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.rel(FlinkPlannerImpl.scala:208)\n\tat org.apache.flink.table.planner.operations.SqlNodeConvertContext.toRelRoot(SqlNodeConvertContext.java:77)\n\tat org.apache.flink.table.planner.operations.converters.SqlQueryConverter.convertSqlNode(SqlQueryConverter.java:48)\n\tat org.apache.flink.table.planner.operations.converters.SqlNodeConverters.convertSqlNode(SqlNodeConverters.java:85)\n\tat org.apache.flink.table.planner.operations.SqlNodeToOperationConversion.convertValidatedSqlNode(SqlNodeToOperationConversion.java:271)\n\tat org.apache.flink.table.planner.operations.SqlNodeToOperationConversion.convert(SqlNodeToOperationConversion.java:261)\n\tat org.apache.flink.table.planner.delegation.ParserImpl.parse(ParserImpl.java:106)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:219)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:199)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.lambda$executeStatement$1(SqlGatewayServiceImpl.java:214)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager.lambda$submitOperation$1(OperationManager.java:119)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:258)\n\t... 7 more\nCaused by: org.apache.flink.table.api.ValidationException: Unsupported options found for 'fluss'.\n\nUnsupported options:\n\nbucket\n\nSupported options:\n\nbootstrap.servers\nbucket.key\nbucket.num\nclient.connect-timeout\nclient.filesystem.security.token.renewal.backoff\nclient.filesystem.security.token.renewal.time-ratio\nclient.id\nclient.lookup.batch-timeout\nclient.lookup.max-batch-size\nclient.lookup.max-inflight-requests\nclient.lookup.queue-size\nclient.metrics.enabled\nclient.remote-file.download-thread-num\nclient.request-timeout\nclient.scanner.io.tmpdir\nclient.scanner.log.check-crc\nclient.scanner.log.fetch.max-bytes\nclient.scanner.log.fetch.max-bytes-for-bucket\nclient.scanner.log.fetch.min-bytes\nclient.scanner.log.fetch.wait-max-time\nclient.scanner.log.max-poll-records\nclient.scanner.remote-log.prefetch-num\nclient.security.protocol\nclient.security.sasl.jaas.config\nclient.security.sasl.mechanism\nclient.security.sasl.password\nclient.security.sasl.username\nclient.writer.acks\nclient.writer.batch-size\nclient.writer.batch-timeout\nclient.writer.bucket.no-key-assigner\nclient.writer.buffer.memory-size\nclient.writer.buffer.page-size\nclient.writer.buffer.per-request-memory-size\nclient.writer.buffer.wait-timeout\nclient.writer.dynamic-batch-size.enabled\nclient.writer.dynamic-create-partition.enabled\nclient.writer.enable-idempotence\nclient.writer.max-inflight-requests-per-bucket\nclient.writer.request-max-size\nclient.writer.retries\nconnector\nlookup.async\nlookup.cache\nlookup.max-retries\nlookup.partial-cache.cache-missing-key\nlookup.partial-cache.expire-after-access\nlookup.partial-cache.expire-after-write\nlookup.partial-cache.max-rows\nproperty-version\nscan.partition.discovery.interval\nscan.startup.mode\nscan.startup.timestamp\nscan.watermark.alignment.group\nscan.watermark.alignment.max-drift\nscan.watermark.alignment.update-interval\nscan.watermark.emit.strategy\nscan.watermark.idle-timeout\nsink.bucket-shuffle\nsink.ignore-delete\ntable.auto-partition.enabled\ntable.auto-partition.key\ntable.auto-partition.num-precreate\ntable.auto-partition.num-retention\ntable.auto-partition.time-unit\ntable.auto-partition.time-zone\ntable.datalake.enabled\ntable.datalake.format\ntable.datalake.freshness\ntable.kv.format\ntable.log.arrow.compression.type\ntable.log.arrow.compression.zstd.level\ntable.log.format\ntable.log.tiered.local-segments\ntable.log.ttl\ntable.merge-engine\ntable.merge-engine.versioned.ver-column\ntable.replication.factor\n\tat org.apache.flink.table.factories.FactoryUtil.validateUnconsumedKeys(FactoryUtil.java:710)\n\tat org.apache.flink.table.factories.FactoryUtil$FactoryHelper.validate(FactoryUtil.java:1009)\n\tat org.apache.flink.table.factories.FactoryUtil$FactoryHelper.validateExcept(FactoryUtil.java:1034)\n\tat com.alibaba.fluss.flink.catalog.FlinkTableFactory.createDynamicTableSource(FlinkTableFactory.java:88)\n\tat org.apache.flink.table.factories.FactoryUtil.createDynamicTableSource(FactoryUtil.java:232)\n\t... 32 more\n\nEnd of exception on server side>"]}
2025-08-15T16:20:17.351Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT COUNT(*) FROM indicators
2025-08-15T16:20:17.351Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:20:17.351Z - INFO - POST data: {"statement":"SELECT COUNT(*) FROM indicators"}
2025-08-15T16:20:17.360Z - INFO - POST response status: 200
2025-08-15T16:20:25.907Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/8e7af98d-a933-4975-9880-1283715ebe8a/result/0
2025-08-15T16:20:25.919Z - ERROR - GET request failed: Request failed with status code 500
2025-08-15T16:20:25.919Z - ERROR - Tool execution error: Failed to fetch results: Request failed with status code 500
2025-08-15T16:20:25.919Z - ERROR - Response status: 500
2025-08-15T16:20:25.919Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:91)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.fetchResults(SqlGatewayServiceImpl.java:231)\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:89)\n\t... 48 more\nCaused by: org.apache.flink.table.gateway.service.utils.SqlExecutionException: Failed to execute the operation 8e7af98d-a933-4975-9880-1283715ebe8a.\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.processThrowable(OperationManager.java:414)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:267)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\t... 1 more\nCaused by: org.apache.flink.table.api.ValidationException: Unable to create a source for reading table 'fluss_catalog.fluss.indicators'.\n\nTable options are:\n\n'bootstrap.servers'='coordinator-server:9123'\n'bucket'='4'\n'bucket.key'='symbol'\n'bucket.num'='1'\n'table.datalake.format'='paimon'\n'table.replication.factor'='1'\n\tat org.apache.flink.table.factories.FactoryUtil.createDynamicTableSource(FactoryUtil.java:235)\n\tat org.apache.flink.table.factories.FactoryUtil.createDynamicTableSource(FactoryUtil.java:260)\n\tat org.apache.flink.table.planner.plan.schema.CatalogSourceTable.createDynamicTableSource(CatalogSourceTable.java:175)\n\tat org.apache.flink.table.planner.plan.schema.CatalogSourceTable.toRel(CatalogSourceTable.java:115)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.toRel(SqlToRelConverter.java:4034)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertIdentifier(SqlToRelConverter.java:2904)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2464)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2378)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertFrom(SqlToRelConverter.java:2323)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertSelectImpl(SqlToRelConverter.java:730)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertSelect(SqlToRelConverter.java:716)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertQueryRecursive(SqlToRelConverter.java:3880)\n\tat org.apache.calcite.sql2rel.SqlToRelConverter.convertQuery(SqlToRelConverter.java:620)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.org$apache$flink$table$planner$calcite$FlinkPlannerImpl$$rel(FlinkPlannerImpl.scala:233)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.rel(FlinkPlannerImpl.scala:208)\n\tat org.apache.flink.table.planner.operations.SqlNodeConvertContext.toRelRoot(SqlNodeConvertContext.java:77)\n\tat org.apache.flink.table.planner.operations.converters.SqlQueryConverter.convertSqlNode(SqlQueryConverter.java:48)\n\tat org.apache.flink.table.planner.operations.converters.SqlNodeConverters.convertSqlNode(SqlNodeConverters.java:85)\n\tat org.apache.flink.table.planner.operations.SqlNodeToOperationConversion.convertValidatedSqlNode(SqlNodeToOperationConversion.java:271)\n\tat org.apache.flink.table.planner.operations.SqlNodeToOperationConversion.convert(SqlNodeToOperationConversion.java:261)\n\tat org.apache.flink.table.planner.delegation.ParserImpl.parse(ParserImpl.java:106)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:219)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:199)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.lambda$executeStatement$1(SqlGatewayServiceImpl.java:214)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager.lambda$submitOperation$1(OperationManager.java:119)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:258)\n\t... 7 more\nCaused by: org.apache.flink.table.api.ValidationException: Unsupported options found for 'fluss'.\n\nUnsupported options:\n\nbucket\n\nSupported options:\n\nbootstrap.servers\nbucket.key\nbucket.num\nclient.connect-timeout\nclient.filesystem.security.token.renewal.backoff\nclient.filesystem.security.token.renewal.time-ratio\nclient.id\nclient.lookup.batch-timeout\nclient.lookup.max-batch-size\nclient.lookup.max-inflight-requests\nclient.lookup.queue-size\nclient.metrics.enabled\nclient.remote-file.download-thread-num\nclient.request-timeout\nclient.scanner.io.tmpdir\nclient.scanner.log.check-crc\nclient.scanner.log.fetch.max-bytes\nclient.scanner.log.fetch.max-bytes-for-bucket\nclient.scanner.log.fetch.min-bytes\nclient.scanner.log.fetch.wait-max-time\nclient.scanner.log.max-poll-records\nclient.scanner.remote-log.prefetch-num\nclient.security.protocol\nclient.security.sasl.jaas.config\nclient.security.sasl.mechanism\nclient.security.sasl.password\nclient.security.sasl.username\nclient.writer.acks\nclient.writer.batch-size\nclient.writer.batch-timeout\nclient.writer.bucket.no-key-assigner\nclient.writer.buffer.memory-size\nclient.writer.buffer.page-size\nclient.writer.buffer.per-request-memory-size\nclient.writer.buffer.wait-timeout\nclient.writer.dynamic-batch-size.enabled\nclient.writer.dynamic-create-partition.enabled\nclient.writer.enable-idempotence\nclient.writer.max-inflight-requests-per-bucket\nclient.writer.request-max-size\nclient.writer.retries\nconnector\nlookup.async\nlookup.cache\nlookup.max-retries\nlookup.partial-cache.cache-missing-key\nlookup.partial-cache.expire-after-access\nlookup.partial-cache.expire-after-write\nlookup.partial-cache.max-rows\nproperty-version\nscan.partition.discovery.interval\nscan.startup.mode\nscan.startup.timestamp\nscan.watermark.alignment.group\nscan.watermark.alignment.max-drift\nscan.watermark.alignment.update-interval\nscan.watermark.emit.strategy\nscan.watermark.idle-timeout\nsink.bucket-shuffle\nsink.ignore-delete\ntable.auto-partition.enabled\ntable.auto-partition.key\ntable.auto-partition.num-precreate\ntable.auto-partition.num-retention\ntable.auto-partition.time-unit\ntable.auto-partition.time-zone\ntable.datalake.enabled\ntable.datalake.format\ntable.datalake.freshness\ntable.kv.format\ntable.log.arrow.compression.type\ntable.log.arrow.compression.zstd.level\ntable.log.format\ntable.log.tiered.local-segments\ntable.log.ttl\ntable.merge-engine\ntable.merge-engine.versioned.ver-column\ntable.replication.factor\n\tat org.apache.flink.table.factories.FactoryUtil.validateUnconsumedKeys(FactoryUtil.java:710)\n\tat org.apache.flink.table.factories.FactoryUtil$FactoryHelper.validate(FactoryUtil.java:1009)\n\tat org.apache.flink.table.factories.FactoryUtil$FactoryHelper.validateExcept(FactoryUtil.java:1034)\n\tat com.alibaba.fluss.flink.catalog.FlinkTableFactory.createDynamicTableSource(FlinkTableFactory.java:88)\n\tat org.apache.flink.table.factories.FactoryUtil.createDynamicTableSource(FactoryUtil.java:232)\n\t... 32 more\n\nEnd of exception on server side>"]}
2025-08-15T16:24:24.543Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: DROP TABLE IF EXISTS indicators
2025-08-15T16:24:24.543Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:24:24.543Z - INFO - POST data: {"statement":"DROP TABLE IF EXISTS indicators"}
2025-08-15T16:24:24.563Z - INFO - POST response status: 200
2025-08-15T16:24:39.363Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: CREATE TABLE indicators (
    symbol STRING NOT NULL,
    `time` TIMESTAMP(3),
    sma5 DOUBLE,
    sma14 DOUBLE,
    sma21 DOUBLE,
    ema5 DOUBLE,
    ema14 DOUBLE,
    ema21 DOUBLE,
    rsi14 DOUBLE,
    PRIMARY KEY (symbol) NOT ENFORCED
) WITH (
    'bucket.num' = '4'
)
2025-08-15T16:24:39.363Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:24:39.363Z - INFO - POST data: {"statement":"CREATE TABLE indicators (\n    symbol STRING NOT NULL,\n    `time` TIMESTAMP(3),\n    sma5 DOUBLE,\n    sma14 DOUBLE,\n    sma21 DOUBLE,\n    ema5 DOUBLE,\n    ema14 DOUBLE,\n    ema21 DOUBLE,\n    rsi14 DOUBLE,\n    PRIMARY KEY (symbol) NOT ENFORCED\n) WITH (\n    'bucket.num' = '4'\n)"}
2025-08-15T16:24:39.369Z - INFO - POST response status: 200
2025-08-15T16:25:41.204Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: CREATE TABLE IF NOT EXISTS indicators_history (
    symbol STRING NOT NULL,
    `time` TIMESTAMP(3),
    sma5 DOUBLE,
    sma14 DOUBLE,
    sma21 DOUBLE,
    ema5 DOUBLE,
    ema14 DOUBLE,
    ema21 DOUBLE,
    rsi14 DOUBLE
) WITH (
    'bucket.num' = '4',
    'table.type' = 'log'
)
2025-08-15T16:25:41.204Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:25:41.204Z - INFO - POST data: {"statement":"CREATE TABLE IF NOT EXISTS indicators_history (\n    symbol STRING NOT NULL,\n    `time` TIMESTAMP(3),\n    sma5 DOUBLE,\n    sma14 DOUBLE,\n    sma21 DOUBLE,\n    ema5 DOUBLE,\n    ema14 DOUBLE,\n    ema21 DOUBLE,\n    rsi14 DOUBLE\n) WITH (\n    'bucket.num' = '4',\n    'table.type' = 'log'\n)"}
2025-08-15T16:25:41.216Z - INFO - POST response status: 200
2025-08-15T16:25:50.947Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SHOW TABLES
2025-08-15T16:25:50.947Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:25:50.947Z - INFO - POST data: {"statement":"SHOW TABLES"}
2025-08-15T16:25:50.957Z - INFO - POST response status: 200
2025-08-15T16:26:00.385Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/6640e9f2-ec0d-48ed-86f6-b104d58a1c1b/result/0
2025-08-15T16:26:00.395Z - INFO - GET response status: 200
2025-08-15T16:26:11.003Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT * FROM indicators LIMIT 5
2025-08-15T16:26:11.003Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:26:11.003Z - INFO - POST data: {"statement":"SELECT * FROM indicators LIMIT 5"}
2025-08-15T16:26:11.009Z - INFO - POST response status: 200
2025-08-15T16:26:20.950Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/fb665991-1d8b-4382-a2e7-33c2c3c1eaaf/result/0
2025-08-15T16:26:20.957Z - INFO - GET response status: 200
2025-08-15T16:34:32.714Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT COUNT(*) as total_records FROM indicators_history
2025-08-15T16:34:32.714Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:34:32.714Z - INFO - POST data: {"statement":"SELECT COUNT(*) as total_records FROM indicators_history"}
2025-08-15T16:34:32.731Z - INFO - POST response status: 200
2025-08-15T16:34:43.225Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/af56afde-2976-4e8c-8c04-f605bd5f85e2/result/0
2025-08-15T16:34:43.233Z - INFO - GET response status: 200
2025-08-15T16:37:23.031Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: DROP TABLE IF EXISTS indicators
2025-08-15T16:37:23.031Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:37:23.032Z - INFO - POST data: {"statement":"DROP TABLE IF EXISTS indicators"}
2025-08-15T16:37:23.040Z - INFO - POST response status: 200
2025-08-15T16:37:34.995Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: CREATE TABLE indicators (
    symbol STRING NOT NULL,
    `time` TIMESTAMP(3) NOT NULL,
    sma5 DOUBLE,
    sma14 DOUBLE,
    sma21 DOUBLE,
    ema5 DOUBLE,
    ema14 DOUBLE,
    ema21 DOUBLE,
    rsi14 DOUBLE,
    PRIMARY KEY (symbol, `time`) NOT ENFORCED
) WITH (
    'bucket.num' = '4'
)
2025-08-15T16:37:34.995Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:37:34.995Z - INFO - POST data: {"statement":"CREATE TABLE indicators (\n    symbol STRING NOT NULL,\n    `time` TIMESTAMP(3) NOT NULL,\n    sma5 DOUBLE,\n    sma14 DOUBLE,\n    sma21 DOUBLE,\n    ema5 DOUBLE,\n    ema14 DOUBLE,\n    ema21 DOUBLE,\n    rsi14 DOUBLE,\n    PRIMARY KEY (symbol, `time`) NOT ENFORCED\n) WITH (\n    'bucket.num' = '4'\n)"}
2025-08-15T16:37:34.999Z - INFO - POST response status: 200
2025-08-15T16:39:11.521Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT symbol, `time`, sma5, sma14, ema5, rsi14 FROM indicators ORDER BY `time` DESC LIMIT 10
2025-08-15T16:39:11.522Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:39:11.522Z - INFO - POST data: {"statement":"SELECT symbol, `time`, sma5, sma14, ema5, rsi14 FROM indicators ORDER BY `time` DESC LIMIT 10"}
2025-08-15T16:39:11.531Z - INFO - POST response status: 200
2025-08-15T16:39:22.716Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/127b09dd-f5ed-4681-82fd-978c30e46c71/result/0
2025-08-15T16:39:22.725Z - INFO - GET response status: 200
2025-08-15T16:39:34.406Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT COUNT(*) as total_count FROM indicators
2025-08-15T16:39:34.407Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:39:34.407Z - INFO - POST data: {"statement":"SELECT COUNT(*) as total_count FROM indicators"}
2025-08-15T16:39:34.410Z - INFO - POST response status: 200
2025-08-15T16:39:52.137Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/a46fa3cb-5c0f-485d-8e66-c12a5ce0060f/result/0
2025-08-15T16:39:52.142Z - INFO - GET response status: 200
2025-08-15T16:43:38.849Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT COUNT(*) as total_rows FROM indicators
2025-08-15T16:43:38.849Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:43:38.849Z - INFO - POST data: {"statement":"SELECT COUNT(*) as total_rows FROM indicators"}
2025-08-15T16:43:38.861Z - INFO - POST response status: 200
2025-08-15T16:43:49.862Z - INFO - GET request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/operations/f9d27440-903a-479e-aef6-2989c14d026a/result/0
2025-08-15T16:43:49.870Z - INFO - GET response status: 200
2025-08-15T16:54:54.635Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SET 'execution.runtime-mode' = 'streaming'
2025-08-15T16:54:54.636Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:54:54.636Z - INFO - POST data: {"statement":"SET 'execution.runtime-mode' = 'streaming'"}
2025-08-15T16:54:54.647Z - ERROR - POST request failed: Request failed with status code 500
2025-08-15T16:54:54.647Z - ERROR - Tool execution error: Failed to execute query: Request failed with status code 500
2025-08-15T16:54:54.647Z - ERROR - Response status: 500
2025-08-15T16:54:54.647Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to execute statement.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:217)\n\tat org.apache.flink.table.gateway.rest.handler.statement.ExecuteStatementHandler.handleRequest(ExecuteStatementHandler.java:72)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Session '887239f9-ae73-40bd-8710-e3f1b8f33d8d' does not exist.\n\tat org.apache.flink.table.gateway.service.session.SessionManagerImpl.getSession(SessionManagerImpl.java:135)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.getSession(SqlGatewayServiceImpl.java:405)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:208)\n\t... 49 more\n\nEnd of exception on server side>"]}
2025-08-15T16:55:07.313Z - INFO - Executing query: /v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements with statement: SELECT * FROM indicators WHERE symbol = 'BTCUSD' AND `time` = TIMESTAMP '2025-08-15 22:40:05.518'
2025-08-15T16:55:07.313Z - INFO - POST request to: http://localhost:8083/v3/sessions/887239f9-ae73-40bd-8710-e3f1b8f33d8d/statements
2025-08-15T16:55:07.313Z - INFO - POST data: {"statement":"SELECT * FROM indicators WHERE symbol = 'BTCUSD' AND `time` = TIMESTAMP '2025-08-15 22:40:05.518'"}
2025-08-15T16:55:07.320Z - ERROR - POST request failed: Request failed with status code 500
2025-08-15T16:55:07.320Z - ERROR - Tool execution error: Failed to execute query: Request failed with status code 500
2025-08-15T16:55:07.320Z - ERROR - Response status: 500
2025-08-15T16:55:07.320Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to execute statement.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:217)\n\tat org.apache.flink.table.gateway.rest.handler.statement.ExecuteStatementHandler.handleRequest(ExecuteStatementHandler.java:72)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Session '887239f9-ae73-40bd-8710-e3f1b8f33d8d' does not exist.\n\tat org.apache.flink.table.gateway.service.session.SessionManagerImpl.getSession(SessionManagerImpl.java:135)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.getSession(SqlGatewayServiceImpl.java:405)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.executeStatement(SqlGatewayServiceImpl.java:208)\n\t... 49 more\n\nEnd of exception on server side>"]}
2025-08-15T22:48:01.905Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-15T22:48:01.909Z - INFO - Flink MCP Server running on stdio
2025-08-15T23:09:49.198Z - INFO - POST request to: http://localhost:8083/v3/sessions
2025-08-15T23:09:49.199Z - INFO - POST data: {}
2025-08-15T23:09:49.387Z - INFO - POST response status: 200
2025-08-15T23:09:53.184Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SELECT * FROM fluss.strategy_signals LIMIT 10
2025-08-15T23:09:53.185Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:09:53.185Z - INFO - POST data: {"statement":"SELECT * FROM fluss.strategy_signals LIMIT 10"}
2025-08-15T23:09:53.198Z - INFO - POST response status: 200
2025-08-15T23:09:57.386Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/2dddd17b-1200-4d80-a678-885a2b05cbb8/result/0
2025-08-15T23:09:57.401Z - ERROR - GET request failed: Request failed with status code 500
2025-08-15T23:09:57.401Z - ERROR - Tool execution error: Failed to fetch results: Request failed with status code 500
2025-08-15T23:09:57.401Z - ERROR - Response status: 500
2025-08-15T23:09:57.401Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:91)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.fetchResults(SqlGatewayServiceImpl.java:231)\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:89)\n\t... 48 more\nCaused by: org.apache.flink.table.gateway.service.utils.SqlExecutionException: Failed to execute the operation 2dddd17b-1200-4d80-a678-885a2b05cbb8.\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.processThrowable(OperationManager.java:414)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:267)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\t... 1 more\nCaused by: org.apache.flink.table.api.ValidationException: SQL validation failed. From line 1, column 15 to line 1, column 36: Object 'fluss' not found\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.org$apache$flink$table$planner$calcite$FlinkPlannerImpl$$validate(FlinkPlannerImpl.scala:203)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.validate(FlinkPlannerImpl.scala:117)\n\tat org.apache.flink.table.planner.operations.SqlNodeToOperationConversion.convert(SqlNodeToOperationConversion.java:260)\n\tat org.apache.flink.table.planner.delegation.ParserImpl.parse(ParserImpl.java:106)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:219)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:199)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.lambda$executeStatement$1(SqlGatewayServiceImpl.java:214)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager.lambda$submitOperation$1(OperationManager.java:119)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:258)\n\t... 7 more\nCaused by: org.apache.calcite.runtime.CalciteContextException: From line 1, column 15 to line 1, column 36: Object 'fluss' not found\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.calcite.runtime.Resources$ExInstWithCause.ex(Resources.java:505)\n\tat org.apache.calcite.sql.SqlUtil.newContextException(SqlUtil.java:932)\n\tat org.apache.calcite.sql.SqlUtil.newContextException(SqlUtil.java:917)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.newValidationError(SqlValidatorImpl.java:5279)\n\tat org.apache.calcite.sql.validate.IdentifierNamespace.resolveImpl(IdentifierNamespace.java:183)\n\tat org.apache.calcite.sql.validate.IdentifierNamespace.validateImpl(IdentifierNamespace.java:188)\n\tat org.apache.calcite.sql.validate.AbstractNamespace.validate(AbstractNamespace.java:89)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateNamespace(SqlValidatorImpl.java:1062)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateQuery(SqlValidatorImpl.java:1037)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateFrom(SqlValidatorImpl.java:3322)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateFrom(SqlValidatorImpl.java:3304)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateSelect(SqlValidatorImpl.java:3631)\n\tat org.apache.calcite.sql.validate.SelectNamespace.validateImpl(SelectNamespace.java:64)\n\tat org.apache.calcite.sql.validate.AbstractNamespace.validate(AbstractNamespace.java:89)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateNamespace(SqlValidatorImpl.java:1062)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateQuery(SqlValidatorImpl.java:1037)\n\tat org.apache.calcite.sql.SqlSelect.validate(SqlSelect.java:248)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validateScopedExpression(SqlValidatorImpl.java:1012)\n\tat org.apache.calcite.sql.validate.SqlValidatorImpl.validate(SqlValidatorImpl.java:761)\n\tat org.apache.flink.table.planner.calcite.FlinkPlannerImpl.org$apache$flink$table$planner$calcite$FlinkPlannerImpl$$validate(FlinkPlannerImpl.scala:199)\n\t... 15 more\nCaused by: org.apache.calcite.sql.validate.SqlValidatorException: Object 'fluss' not found\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstanceWithCaller(Unknown Source)\n\tat java.base/java.lang.reflect.Constructor.newInstance(Unknown Source)\n\tat org.apache.calcite.runtime.Resources$ExInstWithCause.ex(Resources.java:505)\n\tat org.apache.calcite.runtime.Resources$ExInst.ex(Resources.java:599)\n\t... 34 more\n\nEnd of exception on server side>"]}
2025-08-15T23:10:01.338Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SHOW TABLES
2025-08-15T23:10:01.338Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:10:01.338Z - INFO - POST data: {"statement":"SHOW TABLES"}
2025-08-15T23:10:01.346Z - INFO - POST response status: 200
2025-08-15T23:10:05.919Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/5edee5df-4aec-4a67-b654-92e410bedd52/result/0
2025-08-15T23:10:05.943Z - INFO - GET response status: 200
2025-08-15T23:10:10.302Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: USE CATALOG fluss_catalog
2025-08-15T23:10:10.302Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:10:10.302Z - INFO - POST data: {"statement":"USE CATALOG fluss_catalog"}
2025-08-15T23:10:10.309Z - INFO - POST response status: 200
2025-08-15T23:10:14.772Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/dde9ba7a-e939-4406-bb84-4d491818db54/result/0
2025-08-15T23:10:14.782Z - INFO - GET response status: 200
2025-08-15T23:10:18.797Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: USE fluss
2025-08-15T23:10:18.797Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:10:18.797Z - INFO - POST data: {"statement":"USE fluss"}
2025-08-15T23:10:18.803Z - INFO - POST response status: 200
2025-08-15T23:10:23.584Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/37af1341-4ff8-487e-a8e9-05e7aeab0e16/result/0
2025-08-15T23:10:23.592Z - INFO - GET response status: 200
2025-08-15T23:10:28.145Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SHOW TABLES
2025-08-15T23:10:28.146Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:10:28.146Z - INFO - POST data: {"statement":"SHOW TABLES"}
2025-08-15T23:10:28.152Z - INFO - POST response status: 200
2025-08-15T23:10:32.543Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/64f9da57-ca9c-48bc-9994-54980ebd7eb3/result/0
2025-08-15T23:10:32.550Z - INFO - GET response status: 200
2025-08-15T23:10:37.088Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SELECT COUNT(*) FROM strategy_signals
2025-08-15T23:10:37.088Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:10:37.088Z - INFO - POST data: {"statement":"SELECT COUNT(*) FROM strategy_signals"}
2025-08-15T23:10:37.094Z - INFO - POST response status: 200
2025-08-15T23:10:41.805Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/6ab17a42-0e40-4837-9c93-2aff802730de/result/0
2025-08-15T23:10:41.812Z - INFO - GET response status: 200
2025-08-15T23:10:46.751Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SELECT * FROM strategy_signals LIMIT 5
2025-08-15T23:10:46.751Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:10:46.751Z - INFO - POST data: {"statement":"SELECT * FROM strategy_signals LIMIT 5"}
2025-08-15T23:10:46.753Z - INFO - POST response status: 200
2025-08-15T23:10:54.359Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/91d96c43-d6a7-491a-99ed-c9d861be9fd4/result/0
2025-08-15T23:10:54.366Z - INFO - GET response status: 200
2025-08-15T23:11:44.903Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SELECT COUNT(*) as total_signals FROM strategy_signals
2025-08-15T23:11:44.903Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:11:44.904Z - INFO - POST data: {"statement":"SELECT COUNT(*) as total_signals FROM strategy_signals"}
2025-08-15T23:11:44.907Z - INFO - POST response status: 200
2025-08-15T23:11:50.706Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/5436ebf1-8e05-435e-bb7a-2dbd1b46485a/result/0
2025-08-15T23:11:50.712Z - INFO - GET response status: 200
2025-08-15T23:11:56.207Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SELECT signal, COUNT(*) as count FROM strategy_signals GROUP BY signal
2025-08-15T23:11:56.207Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:11:56.207Z - INFO - POST data: {"statement":"SELECT signal, COUNT(*) as count FROM strategy_signals GROUP BY signal"}
2025-08-15T23:11:56.213Z - INFO - POST response status: 200
2025-08-15T23:12:01.454Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/59ced6c1-21cc-4f56-87d1-8c389bc7dbea/result/0
2025-08-15T23:12:01.460Z - ERROR - GET request failed: Request failed with status code 500
2025-08-15T23:12:01.460Z - ERROR - Tool execution error: Failed to fetch results: Request failed with status code 500
2025-08-15T23:12:01.460Z - ERROR - Response status: 500
2025-08-15T23:12:01.460Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:91)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.fetchResults(SqlGatewayServiceImpl.java:231)\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:89)\n\t... 48 more\nCaused by: org.apache.flink.table.gateway.service.utils.SqlExecutionException: Failed to execute the operation 59ced6c1-21cc-4f56-87d1-8c389bc7dbea.\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.processThrowable(OperationManager.java:414)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:267)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\t... 1 more\nCaused by: org.apache.flink.table.api.SqlParserException: SQL parse failed. Encountered \"count\" at line 1, column 28.\nWas expecting one of:\n    <QUOTED_STRING> ...\n    <BRACKET_QUOTED_IDENTIFIER> ...\n    <QUOTED_IDENTIFIER> ...\n    <BACK_QUOTED_IDENTIFIER> ...\n    <BIG_QUERY_BACK_QUOTED_IDENTIFIER> ...\n    <HYPHENATED_IDENTIFIER> ...\n    <IDENTIFIER> ...\n    <UNICODE_QUOTED_IDENTIFIER> ...\n    \n\tat org.apache.flink.table.planner.parse.CalciteParser.parseSqlList(CalciteParser.java:81)\n\tat org.apache.flink.table.planner.delegation.ParserImpl.parse(ParserImpl.java:102)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:219)\n\tat org.apache.flink.table.gateway.service.operation.OperationExecutor.executeStatement(OperationExecutor.java:199)\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.lambda$executeStatement$1(SqlGatewayServiceImpl.java:214)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager.lambda$submitOperation$1(OperationManager.java:119)\n\tat org.apache.flink.table.gateway.service.operation.OperationManager$Operation.lambda$run$0(OperationManager.java:258)\n\t... 7 more\nCaused by: org.apache.calcite.sql.parser.SqlParseException: Encountered \"count\" at line 1, column 28.\nWas expecting one of:\n    <QUOTED_STRING> ...\n    <BRACKET_QUOTED_IDENTIFIER> ...\n    <QUOTED_IDENTIFIER> ...\n    <BACK_QUOTED_IDENTIFIER> ...\n    <BIG_QUERY_BACK_QUOTED_IDENTIFIER> ...\n    <HYPHENATED_IDENTIFIER> ...\n    <IDENTIFIER> ...\n    <UNICODE_QUOTED_IDENTIFIER> ...\n    \n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.convertException(FlinkSqlParserImpl.java:539)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.normalizeException(FlinkSqlParserImpl.java:292)\n\tat org.apache.calcite.sql.parser.SqlParser.handleException(SqlParser.java:156)\n\tat org.apache.calcite.sql.parser.SqlParser.parseStmtList(SqlParser.java:211)\n\tat org.apache.flink.table.planner.parse.CalciteParser.parseSqlList(CalciteParser.java:76)\n\t... 13 more\nCaused by: org.apache.flink.sql.parser.impl.ParseException: Encountered \"count\" at line 1, column 28.\nWas expecting one of:\n    <QUOTED_STRING> ...\n    <BRACKET_QUOTED_IDENTIFIER> ...\n    <QUOTED_IDENTIFIER> ...\n    <BACK_QUOTED_IDENTIFIER> ...\n    <BIG_QUERY_BACK_QUOTED_IDENTIFIER> ...\n    <HYPHENATED_IDENTIFIER> ...\n    <IDENTIFIER> ...\n    <UNICODE_QUOTED_IDENTIFIER> ...\n    \n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.generateParseException(FlinkSqlParserImpl.java:50082)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.jj_consume_token(FlinkSqlParserImpl.java:49890)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.AddSelectItem(FlinkSqlParserImpl.java:18414)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.SqlSelect(FlinkSqlParserImpl.java:13528)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.LeafQuery(FlinkSqlParserImpl.java:902)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.LeafQueryOrExpr(FlinkSqlParserImpl.java:25958)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.QueryOrExpr(FlinkSqlParserImpl.java:25319)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.OrderedQueryOrExpr(FlinkSqlParserImpl.java:709)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.SqlStmt(FlinkSqlParserImpl.java:4310)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.SqlStmtList(FlinkSqlParserImpl.java:3181)\n\tat org.apache.flink.sql.parser.impl.FlinkSqlParserImpl.parseSqlStmtList(FlinkSqlParserImpl.java:348)\n\tat org.apache.calcite.sql.parser.SqlParser.parseStmtList(SqlParser.java:209)\n\t... 14 more\n\nEnd of exception on server side>"]}
2025-08-15T23:12:06.501Z - INFO - Executing query: /v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements with statement: SELECT * FROM strategy_signals LIMIT 20
2025-08-15T23:12:06.501Z - INFO - POST request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/statements
2025-08-15T23:12:06.501Z - INFO - POST data: {"statement":"SELECT * FROM strategy_signals LIMIT 20"}
2025-08-15T23:12:06.507Z - INFO - POST response status: 200
2025-08-15T23:12:11.798Z - INFO - GET request to: http://localhost:8083/v3/sessions/0f78563b-fb92-425a-8c57-26b5ce6433d5/operations/34c7b08c-6c05-47f2-8556-8ffb8a6c2e28/result/0
2025-08-15T23:12:11.807Z - INFO - GET response status: 200
2025-08-16T00:11:50.897Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-16T00:11:50.900Z - INFO - Flink MCP Server running on stdio
2025-08-16T13:09:13.329Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-16T13:09:13.332Z - INFO - Flink MCP Server running on stdio
2025-08-16T13:10:20.399Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-16T13:10:20.403Z - INFO - Flink MCP Server running on stdio
2025-08-16T17:54:21.304Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-16T17:54:21.307Z - INFO - Flink MCP Server running on stdio
2025-08-16T19:01:22.417Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-16T19:01:22.421Z - INFO - Flink MCP Server running on stdio
2025-08-17T12:35:50.198Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-17T12:35:50.201Z - INFO - Flink MCP Server running on stdio
2025-08-17T12:36:50.560Z - INFO - POST request to: http://localhost:8083/v3/sessions
2025-08-17T12:36:50.560Z - INFO - POST data: {}
2025-08-17T12:36:50.779Z - INFO - POST response status: 200
2025-08-17T12:37:05.252Z - INFO - Executing query: /v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements with statement: USE CATALOG fluss_catalog;
2025-08-17T12:37:05.252Z - INFO - POST request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements
2025-08-17T12:37:05.252Z - INFO - POST data: {"statement":"USE CATALOG fluss_catalog;"}
2025-08-17T12:37:05.270Z - INFO - POST response status: 200
2025-08-17T12:37:08.581Z - INFO - GET request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/operations/25c9ae97-97c0-4d77-a220-4251cfc3d45f/result/0
2025-08-17T12:37:08.615Z - INFO - GET response status: 200
2025-08-17T12:37:31.392Z - INFO - Executing query: /v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements with statement: SET 'execution.runtime-mode' = 'batch'
2025-08-17T12:37:31.393Z - INFO - POST request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements
2025-08-17T12:37:31.393Z - INFO - POST data: {"statement":"SET 'execution.runtime-mode' = 'batch'"}
2025-08-17T12:37:31.404Z - INFO - POST response status: 200
2025-08-17T12:37:34.391Z - INFO - GET request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/operations/5a68ca94-5942-4275-8d39-8ccbdac0c024/result/0
2025-08-17T12:37:34.398Z - INFO - GET response status: 200
2025-08-17T12:38:00.872Z - INFO - Executing query: /v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements with statement: select * from market_data_history
2025-08-17T12:38:00.872Z - INFO - POST request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements
2025-08-17T12:38:00.872Z - INFO - POST data: {"statement":"select * from market_data_history"}
2025-08-17T12:38:00.881Z - INFO - POST response status: 200
2025-08-17T12:38:03.923Z - INFO - GET request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/operations/17bacc2c-bff2-46e7-894e-7f6cc3b84528/result/0
2025-08-17T12:38:03.954Z - ERROR - GET request failed: Request failed with status code 500
2025-08-17T12:38:03.954Z - ERROR - Tool execution error: Failed to fetch results: Request failed with status code 500
2025-08-17T12:38:03.954Z - ERROR - Response status: 500
2025-08-17T12:38:03.954Z - ERROR - Response data: {"errors":["Internal server error.","<Exception on server side:\norg.apache.flink.table.gateway.api.utils.SqlGatewayException: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:91)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:84)\n\tat org.apache.flink.table.gateway.rest.handler.AbstractSqlGatewayRestHandler.respondToRequest(AbstractSqlGatewayRestHandler.java:52)\n\tat org.apache.flink.runtime.rest.handler.AbstractHandler.respondAsLeader(AbstractHandler.java:196)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.lambda$channelRead0$0(LeaderRetrievalHandler.java:88)\n\tat java.base/java.util.Optional.ifPresent(Unknown Source)\n\tat org.apache.flink.util.OptionalConsumer.ifPresent(OptionalConsumer.java:45)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:85)\n\tat org.apache.flink.runtime.rest.handler.LeaderRetrievalHandler.channelRead0(LeaderRetrievalHandler.java:50)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.routed(RouterHandler.java:115)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:94)\n\tat org.apache.flink.runtime.rest.handler.router.RouterHandler.channelRead0(RouterHandler.java:55)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.MessageToMessageDecoder.channelRead(MessageToMessageDecoder.java:103)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:233)\n\tat org.apache.flink.runtime.rest.FileUploadHandler.channelRead0(FileUploadHandler.java:70)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.SimpleChannelInboundHandler.channelRead(SimpleChannelInboundHandler.java:99)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:444)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346)\n\tat org.apache.flink.shaded.netty4.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1410)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:919)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.AbstractNioByteChannel$NioByteUnsafe.read(AbstractNioByteChannel.java:166)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:788)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:724)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:650)\n\tat org.apache.flink.shaded.netty4.io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:562)\n\tat org.apache.flink.shaded.netty4.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:997)\n\tat org.apache.flink.shaded.netty4.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.table.gateway.api.utils.SqlGatewayException: Failed to fetchResults.\n\tat org.apache.flink.table.gateway.service.SqlGatewayServiceImpl.fetchResults(SqlGatewayServiceImpl.java:231)\n\tat org.apache.flink.table.gateway.rest.handler.statement.FetchResultsHandler.handleRequest(FetchResultsHandler.java:89)\n\t... 48 more\nCaused by: org.apache.flink.table.gateway.service.utils.SqlExecutionException: Error while retrieving result.\n\tat org.apache.flink.table.gateway.service.result.ResultStore$ResultRetrievalThread.run(ResultStore.java:159)\nCaused by: java.lang.RuntimeException: Failed to fetch next result\n\tat org.apache.flink.streaming.api.operators.collect.CollectResultIterator.nextResultFromFetcher(CollectResultIterator.java:129)\n\tat org.apache.flink.streaming.api.operators.collect.CollectResultIterator.hasNext(CollectResultIterator.java:100)\n\tat org.apache.flink.table.planner.connectors.CollectDynamicSink$CloseableRowIteratorWrapper.hasNext(CollectDynamicSink.java:247)\n\tat org.apache.flink.table.gateway.service.result.ResultStore$ResultRetrievalThread.run(ResultStore.java:155)\nCaused by: java.io.IOException: Failed to fetch job execution result\n\tat org.apache.flink.streaming.api.operators.collect.CollectResultFetcher.getAccumulatorResults(CollectResultFetcher.java:187)\n\tat org.apache.flink.streaming.api.operators.collect.CollectResultFetcher.next(CollectResultFetcher.java:123)\n\tat org.apache.flink.streaming.api.operators.collect.CollectResultIterator.nextResultFromFetcher(CollectResultIterator.java:126)\n\t... 3 more\nCaused by: java.util.concurrent.ExecutionException: org.apache.flink.client.program.ProgramInvocationException: Job failed (JobID: f00fba7b7918f3ab019cdc937debe401)\n\tat java.base/java.util.concurrent.CompletableFuture.reportGet(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.get(Unknown Source)\n\tat org.apache.flink.streaming.api.operators.collect.CollectResultFetcher.getAccumulatorResults(CollectResultFetcher.java:185)\n\t... 5 more\nCaused by: org.apache.flink.client.program.ProgramInvocationException: Job failed (JobID: f00fba7b7918f3ab019cdc937debe401)\n\tat org.apache.flink.client.deployment.ClusterClientJobClientAdapter.lambda$null$6(ClusterClientJobClientAdapter.java:130)\n\tat java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.complete(Unknown Source)\n\tat org.apache.flink.util.concurrent.FutureUtils.lambda$retryOperationWithDelay$6(FutureUtils.java:302)\n\tat java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.complete(Unknown Source)\n\tat org.apache.flink.client.program.rest.RestClusterClient.lambda$pollResourceAsync$35(RestClusterClient.java:901)\n\tat java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.complete(Unknown Source)\n\tat org.apache.flink.util.concurrent.FutureUtils.lambda$retryOperationWithDelay$6(FutureUtils.java:302)\n\tat java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.postComplete(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.postFire(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture$UniCompose.tryFire(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture$Completion.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.runtime.client.JobExecutionException: Job execution failed.\n\tat org.apache.flink.runtime.jobmaster.JobResult.toJobExecutionResult(JobResult.java:144)\n\tat org.apache.flink.client.deployment.ClusterClientJobClientAdapter.lambda$null$6(ClusterClientJobClientAdapter.java:128)\n\t... 23 more\nCaused by: org.apache.flink.runtime.JobException: Recovery is suppressed by NoRestartBackoffTimeStrategy\n\tat org.apache.flink.runtime.executiongraph.failover.ExecutionFailureHandler.handleFailure(ExecutionFailureHandler.java:219)\n\tat org.apache.flink.runtime.executiongraph.failover.ExecutionFailureHandler.handleFailureAndReport(ExecutionFailureHandler.java:166)\n\tat org.apache.flink.runtime.executiongraph.failover.ExecutionFailureHandler.getGlobalFailureHandlingResult(ExecutionFailureHandler.java:140)\n\tat org.apache.flink.runtime.scheduler.DefaultScheduler.handleGlobalFailure(DefaultScheduler.java:324)\n\tat org.apache.flink.runtime.operators.coordination.OperatorCoordinatorHolder$LazyInitializedCoordinatorContext.lambda$failJob$0(OperatorCoordinatorHolder.java:669)\n\tat org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.lambda$handleRunAsync$4(PekkoRpcActor.java:460)\n\tat org.apache.flink.runtime.concurrent.ClassLoadingUtils.runWithContextClassLoader(ClassLoadingUtils.java:68)\n\tat org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRunAsync(PekkoRpcActor.java:460)\n\tat org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleRpcMessage(PekkoRpcActor.java:225)\n\tat org.apache.flink.runtime.rpc.pekko.FencedPekkoRpcActor.handleRpcMessage(FencedPekkoRpcActor.java:88)\n\tat org.apache.flink.runtime.rpc.pekko.PekkoRpcActor.handleMessage(PekkoRpcActor.java:174)\n\tat org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:33)\n\tat org.apache.pekko.japi.pf.UnitCaseStatement.apply(CaseStatements.scala:29)\n\tat scala.PartialFunction.applyOrElse(PartialFunction.scala:127)\n\tat scala.PartialFunction.applyOrElse$(PartialFunction.scala:126)\n\tat org.apache.pekko.japi.pf.UnitCaseStatement.applyOrElse(CaseStatements.scala:29)\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:175)\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176)\n\tat scala.PartialFunction$OrElse.applyOrElse(PartialFunction.scala:176)\n\tat org.apache.pekko.actor.Actor.aroundReceive(Actor.scala:547)\n\tat org.apache.pekko.actor.Actor.aroundReceive$(Actor.scala:545)\n\tat org.apache.pekko.actor.AbstractActor.aroundReceive(AbstractActor.scala:229)\n\tat org.apache.pekko.actor.ActorCell.receiveMessage(ActorCell.scala:590)\n\tat org.apache.pekko.actor.ActorCell.invoke(ActorCell.scala:557)\n\tat org.apache.pekko.dispatch.Mailbox.processMailbox(Mailbox.scala:280)\n\tat org.apache.pekko.dispatch.Mailbox.run(Mailbox.scala:241)\n\tat org.apache.pekko.dispatch.Mailbox.exec(Mailbox.scala:253)\n\tat java.base/java.util.concurrent.ForkJoinTask.doExec(Unknown Source)\n\tat java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(Unknown Source)\n\tat java.base/java.util.concurrent.ForkJoinPool.scan(Unknown Source)\n\tat java.base/java.util.concurrent.ForkJoinPool.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ForkJoinWorkerThread.run(Unknown Source)\nCaused by: org.apache.flink.util.FlinkException: Global failure triggered by OperatorCoordinator for 'Source: market_data_history[1] -> Sink: Collect table sink' (operator cbc357ccb763df2852fee8c4fc7d55f2).\n\tat org.apache.flink.runtime.operators.coordination.OperatorCoordinatorHolder$LazyInitializedCoordinatorContext.failJob(OperatorCoordinatorHolder.java:651)\n\tat org.apache.flink.runtime.operators.coordination.RecreateOnResetOperatorCoordinator$QuiesceableContext.failJob(RecreateOnResetOperatorCoordinator.java:259)\n\tat org.apache.flink.runtime.source.coordinator.SourceCoordinatorContext.failJob(SourceCoordinatorContext.java:432)\n\tat org.apache.flink.runtime.source.coordinator.SourceCoordinatorContext.handleUncaughtExceptionFromAsyncCall(SourceCoordinatorContext.java:445)\n\tat org.apache.flink.util.ThrowableCatchingRunnable.run(ThrowableCatchingRunnable.java:42)\n\tat java.base/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)\n\tat java.base/java.util.concurrent.FutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)\n\tat java.base/java.lang.Thread.run(Unknown Source)\nCaused by: org.apache.flink.util.FlinkRuntimeException: Failed to list splits for fluss.market_data_history to read due to \n\tat com.alibaba.fluss.flink.source.enumerator.FlinkSourceEnumerator.handleSplitsAdd(FlinkSourceEnumerator.java:534)\n\tat org.apache.flink.runtime.source.coordinator.ExecutorNotifier.lambda$null$1(ExecutorNotifier.java:83)\n\tat org.apache.flink.util.ThrowableCatchingRunnable.run(ThrowableCatchingRunnable.java:40)\n\t... 6 more\nCaused by: java.util.concurrent.ExecutionException: com.alibaba.fluss.exception.LakeTableSnapshotNotExistException: Lake table snapshot not exist for table: fluss.market_data_history, table id: 0\n\tat java.base/java.util.concurrent.CompletableFuture.reportGet(Unknown Source)\n\tat java.base/java.util.concurrent.CompletableFuture.get(Unknown Source)\n\tat com.alibaba.fluss.flink.lakehouse.LakeSplitGenerator.generateLakeSplits(LakeSplitGenerator.java:83)\n\tat com.alibaba.fluss.flink.source.enumerator.FlinkSourceEnumerator.getLakeSplit(FlinkSourceEnumerator.java:490)\n\tat org.apache.flink.runtime.source.coordinator.ExecutorNotifier.lambda$notifyReadyAsync$2(ExecutorNotifier.java:80)\n\t... 6 more\nCaused by: com.alibaba.fluss.exception.LakeTableSnapshotNotExistException: Lake table snapshot not exist for table: fluss.market_data_history, table id: 0\n\nEnd of exception on server side>"]}
2025-08-17T12:38:07.434Z - INFO - Executing query: /v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements with statement: SHOW TABLES
2025-08-17T12:38:07.434Z - INFO - POST request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements
2025-08-17T12:38:07.434Z - INFO - POST data: {"statement":"SHOW TABLES"}
2025-08-17T12:38:07.442Z - INFO - POST response status: 200
2025-08-17T12:38:10.475Z - INFO - GET request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/operations/6d479d06-b545-4040-80df-0df2fe4c890e/result/0
2025-08-17T12:38:10.483Z - INFO - GET response status: 200
2025-08-17T12:38:56.898Z - INFO - Executing query: /v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements with statement: SET 'execution.runtime-mode' = 'streaming'
2025-08-17T12:38:56.898Z - INFO - POST request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements
2025-08-17T12:38:56.898Z - INFO - POST data: {"statement":"SET 'execution.runtime-mode' = 'streaming'"}
2025-08-17T12:38:56.906Z - INFO - POST response status: 200
2025-08-17T12:38:59.760Z - INFO - GET request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/operations/6950b4df-08d9-4a63-9eb3-c01645e11a51/result/0
2025-08-17T12:38:59.766Z - INFO - GET response status: 200
2025-08-17T12:39:02.810Z - INFO - Executing query: /v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements with statement: select * from market_data_history LIMIT 10
2025-08-17T12:39:02.810Z - INFO - POST request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/statements
2025-08-17T12:39:02.810Z - INFO - POST data: {"statement":"select * from market_data_history LIMIT 10"}
2025-08-17T12:39:02.813Z - INFO - POST response status: 200
2025-08-17T12:39:05.950Z - INFO - GET request to: http://localhost:8083/v3/sessions/7cccee17-d0e3-44eb-8249-bad78bd46278/operations/5aa525e9-5df8-4fb1-8451-8dc25e69879b/result/0
2025-08-17T12:39:05.954Z - INFO - GET response status: 200
2025-08-18T20:14:28.022Z - INFO - Flink MCP Server Connecting to: http://localhost:8083
2025-08-18T20:14:28.025Z - INFO - Flink MCP Server running on stdio
